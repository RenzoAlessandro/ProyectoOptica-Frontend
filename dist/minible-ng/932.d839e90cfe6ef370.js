"use strict";(self.webpackChunkminible_ng=self.webpackChunkminible_ng||[]).push([[932],{2974:(F,q,l)=>{l.d(q,{o:()=>g});var h=l(83668);let g=(()=>{class f{}return f.\u0275fac=function(e){return new(e||f)},f.\u0275mod=h.oAB({type:f}),f.\u0275inj=h.cJS({imports:[[]]}),f})()},61932:(F,q,l)=>{l.r(q),l.d(q,{CashRegisterModule:()=>Le});var h=l(86019),g=l(49133),f=l(56225),x=l(85298),e=l(83668);const A={asc:"desc",desc:"","":"asc"};let v=(()=>{class r{constructor(){this.sortable="",this.direction="",this.sort=new e.vpe}rotate(){this.direction=A[this.direction],this.sort.emit({column:this.sortable,direction:this.direction})}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=e.lG2({type:r,selectors:[["th","sortable",""]],hostVars:4,hostBindings:function(t,o){1&t&&e.NdJ("click",function(){return o.rotate()}),2&t&&e.ekj("asc","asc"===o.direction)("desc","desc"===o.direction)},inputs:{sortable:"sortable",direction:"direction"},outputs:{sort:"sort"}}),r})();class C{}var _=l(34099),E=l(23405),U=l(22411),S=l(81366),y=l(65686),w=l(79204),D=l(5250),b=l(18260),z=l(44522);let J=(()=>{class r{constructor(t){this.http=t}getIngresos(){return this.http.get(b.N.urlBackend+"getAllIngresos")}getIngresosbyDate(t,o,s){return this.http.get(b.N.urlBackend+"getAllIngresosByDate/"+t+"/"+o+"/"+s)}getEgresosbyDate(t,o,s){return this.http.get(b.N.urlBackend+"getAllEgresosByDate/"+t+"/"+o+"/"+s)}getIngresosEgresosbyMonth(t,o,s){return this.http.get(b.N.urlBackend+"getAllCajaPerMonths/"+t+"/"+o+"/"+s)}getEgresos(){return this.http.get(b.N.urlBackend+"getAllEgresos")}createIngresoEgreso(t){return this.http.post(b.N.urlBackend+"createNewIngreso",t)}deleteIngresoEgreso(t){return this.http.put(b.N.urlBackend+"unsubscribeEgresoById/"+t.id_caja,t)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(z.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var M=l(20566);let Q=(()=>{class r{constructor(t,o,s){this.pipe=t,this.cajaService=o,this.usuarioService=s,this._loadingI$=new _.X(!0),this._searchI$=new E.xQ,this._ingreso$=new _.X([]),this._totalI$=new _.X(0),this.ingresoList=[],this._state={page:1,pageSize:5,searchTerm:"",sortColumn:"",sortDirection:""};let i=new Date(Date.now());i.setHours(0,0,1);let a=new Date(Date.now());a.setHours(23,59,0),this.getListIngresos(i,a)}updateTableIngreso(t){this._ingreso$.next(t)}get ingreso$(){return this._ingreso$.asObservable()}get totalI$(){return this._totalI$.asObservable()}get loadingI$(){return this._loadingI$.asObservable()}get pageI(){return this._state.page}get pageSizeI(){return this._state.pageSize}get searchTermI(){return this._state.searchTerm}set pageI(t){this._setI({page:t})}set pageSizeI(t){this._setI({pageSize:t})}set searchTermI(t){this._setI({searchTerm:t})}set sortColumnI(t){this._setI({sortColumn:t})}set sortDirectionI(t){this._setI({sortDirection:t})}_setI(t){Object.assign(this._state,t),this._searchI$.next()}_searchI(){const{sortColumn:t,sortDirection:o,pageSize:s,page:i,searchTerm:a}=this._state;let c=function(r,n,t){return""===t||""===n?r:[...r].sort((o,s)=>{const i=((r,n)=>r<n?-1:r>n?1:0)(o[n],s[n]);return"asc"===t?i:-i})}(this.ingresoList,t,o);c=c.filter(u=>function(r,n,t){return String(r.monto).toLowerCase().includes(n)||r.descripcion.toLowerCase().includes(n.toLowerCase())||String(r.encargado).toLowerCase().includes(n.toLowerCase())}(u,a));const d=c.length;return c=c.slice((i-1)*s,(i-1)*s+s),(0,U.of)({invoices:c,total:d})}getListIngresos(t,o){this.cajaService.getIngresosbyDate(t,o,this.usuarioService.getSedebyUser()).subscribe(s=>{this.ingresoList=s,this._searchI$.pipe((0,S.b)(()=>this._loadingI$.next(!0)),(0,y.b)(200),(0,w.w)(()=>this._searchI()),(0,D.g)(200),(0,S.b)(()=>this._loadingI$.next(!1))).subscribe(i=>{this._ingreso$.next(i.invoices),this._totalI$.next(i.total)}),this._searchI$.next()})}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(h.JJ),e.LFG(J),e.LFG(M.i))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),$=(()=>{class r{constructor(t,o,s){this.pipe=t,this.cajaService=o,this.usuarioService=s,this._loadingE$=new _.X(!0),this._searchE$=new E.xQ,this._egresos$=new _.X([]),this._totalE$=new _.X(0),this.egresoList=[],this._state={page:1,pageSize:5,searchTerm:"",sortColumn:"",sortDirection:""};let i=new Date(Date.now());i.setHours(0,0,1);let a=new Date(Date.now());a.setHours(23,59,0),this.getListEgresos(i,a)}updateTableEgreso(t){this._egresos$.next(t)}get egresos$(){return this._egresos$.asObservable()}get totalE$(){return this._totalE$.asObservable()}get loadingE$(){return this._loadingE$.asObservable()}get pageE(){return this._state.page}get pageSizeE(){return this._state.pageSize}get searchTermE(){return this._state.searchTerm}set pageE(t){this._setE({page:t})}set pageSizeE(t){this._setE({pageSize:t})}set searchTermE(t){this._setE({searchTerm:t})}set sortColumnE(t){this._setE({sortColumn:t})}set sortDirectionE(t){this._setE({sortDirection:t})}_setE(t){Object.assign(this._state,t),this._searchE$.next()}_searchE(){const{sortColumn:t,sortDirection:o,pageSize:s,page:i,searchTerm:a}=this._state;let c=function(r,n,t){return""===t||""===n?r:[...r].sort((o,s)=>{const i=((r,n)=>r<n?-1:r>n?1:0)(o[n],s[n]);return"asc"===t?i:-i})}(this.egresoList,t,o);c=c.filter(u=>function(r,n,t){return String(r.monto).toLowerCase().includes(n)||r.descripcion.toLowerCase().includes(n.toLowerCase())||String(r.encargado).toLowerCase().includes(n.toLowerCase())}(u,a));const d=c.length;return c=c.slice((i-1)*s,(i-1)*s+s),(0,U.of)({invoices:c,total:d})}getListEgresos(t,o){this.cajaService.getEgresosbyDate(t,o,this.usuarioService.getSedebyUser()).subscribe(s=>{this.egresoList=s,this._searchE$.pipe((0,S.b)(()=>this._loadingE$.next(!0)),(0,y.b)(200),(0,w.w)(()=>this._searchE()),(0,D.g)(200),(0,S.b)(()=>this._loadingE$.next(!1))).subscribe(i=>{this._egresos$.next(i.invoices),this._totalE$.next(i.total)}),this._searchE$.next()})}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(h.JJ),e.LFG(J),e.LFG(M.i))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var T=l(63782),X=l(1659),L=l.n(X),p=l(20154),H=l(11950),K=l(48185),N=l(40345);function W(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"form",46),e.TgZ(2,"div",47),e.TgZ(3,"ng-select",48),e.NdJ("change",function(){return e.CHM(t),e.oxw().changeSede()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.formSedes),e.xp6(2),e.s9C("formControlName",t.nombre_sedes),e.Q6J("items",t.listSedes)}}function ee(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"ngb-highlight",49),e.ALo(3,"currency"),e.qZA(),e.TgZ(4,"td"),e._UZ(5,"ngb-highlight",49),e.qZA(),e.TgZ(6,"td"),e._UZ(7,"ngb-highlight",49),e.qZA(),e.TgZ(8,"td"),e._UZ(9,"ngb-highlight",49),e.qZA(),e.TgZ(10,"td"),e._UZ(11,"ngb-highlight",49),e.qZA(),e.TgZ(12,"td"),e.TgZ(13,"a",50),e.NdJ("click",function(){const i=e.CHM(t).$implicit;return e.oxw().eliminarIngreso(i)}),e._UZ(14,"i",51),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=n.$implicit,o=e.oxw();e.xp6(2),e.Q6J("result",e.xi3(3,10,t.monto,"S/ "))("term",o.serviceI.searchTerm),e.xp6(3),e.Q6J("result",t.metodo_pago)("term",o.serviceI.searchTerm),e.xp6(2),e.Q6J("result",t.descripcion)("term",o.serviceI.searchTerm),e.xp6(2),e.Q6J("result",t.fecha_creacion_caja)("term",o.serviceI.searchTerm),e.xp6(2),e.Q6J("result","-")("term",o.serviceI.searchTerm)}}function te(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"ngb-highlight",49),e.ALo(3,"currency"),e.qZA(),e.TgZ(4,"td"),e._UZ(5,"ngb-highlight",49),e.qZA(),e.TgZ(6,"td"),e._UZ(7,"ngb-highlight",49),e.qZA(),e.TgZ(8,"td"),e._UZ(9,"ngb-highlight",49),e.qZA(),e.TgZ(10,"td"),e._UZ(11,"ngb-highlight",49),e.qZA(),e.TgZ(12,"td"),e.TgZ(13,"a",50),e.NdJ("click",function(){const i=e.CHM(t).$implicit;return e.oxw().eliminarIngreso(i)}),e._UZ(14,"i",51),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=n.$implicit,o=e.oxw();e.xp6(2),e.Q6J("result",e.xi3(3,10,t.monto,"S/ "))("term",o.serviceE.searchTerm),e.xp6(3),e.Q6J("result",t.metodo_pago)("term",o.serviceE.searchTerm),e.xp6(2),e.Q6J("result",t.descripcion)("term",o.serviceE.searchTerm),e.xp6(2),e.Q6J("result",t.fecha_creacion_caja)("term",o.serviceE.searchTerm),e.xp6(2),e.Q6J("result","-")("term",o.serviceE.searchTerm)}}function oe(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Campo requerido. "),e.qZA())}function re(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Ingrese solo n\xfameros. "),e.qZA())}function se(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Campo requerido. "),e.qZA())}function ie(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Campo requerido. "),e.qZA())}function ne(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," La descripci\xf3n debe ser menor a 50 caracteres. "),e.qZA())}const I=function(r){return{"is-invalid":r}};function ae(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",52),e.TgZ(1,"h5",53),e._uU(2,"Nuevo Ingreso"),e.qZA(),e.TgZ(3,"button",54),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e.qZA(),e.qZA(),e.TgZ(4,"div",55),e.TgZ(5,"form",46),e.TgZ(6,"div",20),e.TgZ(7,"div",21),e.TgZ(8,"div",56),e.TgZ(9,"label",57),e._uU(10,"Monto"),e.qZA(),e._UZ(11,"input",58),e.TgZ(12,"div",59),e.YNc(13,oe,2,0,"div",60),e.YNc(14,re,2,0,"div",60),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",21),e.TgZ(16,"div",56),e.TgZ(17,"label",57),e._uU(18,"M\xe9todo"),e.qZA(),e._UZ(19,"ng-select",61),e.TgZ(20,"div",59),e.YNc(21,se,2,0,"div",60),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(22,"div",20),e.TgZ(23,"div",15),e.TgZ(24,"div",56),e.TgZ(25,"label",57),e._uU(26,"Descripci\xf3n"),e.qZA(),e.TgZ(27,"textarea",62),e._uU(28,"            "),e.qZA(),e.TgZ(29,"div",59),e.YNc(30,ie,2,0,"div",60),e.YNc(31,ne,2,0,"div",60),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"div",63),e.TgZ(33,"button",64),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e._uU(34," Cerrar "),e.qZA(),e.TgZ(35,"button",65),e.NdJ("click",function(){return e.CHM(t),e.oxw().guardarIngreso()}),e._uU(36," Guardar "),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("formGroup",t.formIngreso),e.xp6(6),e.s9C("formControlName",t.monto_ingreso),e.Q6J("ngClass",e.VKq(14,I,t.formCI.campoMontoIngreso.invalid&&(t.formCI.campoMontoIngreso.dirty||t.formCI.campoMontoIngreso.touched))),e.xp6(2),e.Q6J("ngIf",null==t.formCI.campoMontoIngreso.errors?null:t.formCI.campoMontoIngreso.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.formCI.campoMontoIngreso.errors?null:t.formCI.campoMontoIngreso.errors.pattern),e.xp6(5),e.s9C("formControlName",t.metodoPagoContado_ingreso),e.Q6J("items",t.listMetodosPagos)("ngClass",e.VKq(16,I,t.formCI.campoMetodoPagoContadoIngreso.invalid&&(t.formCI.campoMetodoPagoContadoIngreso.dirty||t.formCI.campoMetodoPagoContadoIngreso.touched))),e.xp6(2),e.Q6J("ngIf",null==t.formCI.campoMetodoPagoContadoIngreso.errors?null:t.formCI.campoMetodoPagoContadoIngreso.errors.required),e.xp6(6),e.s9C("formControlName",t.descripcion_ingreso),e.Q6J("ngClass",e.VKq(18,I,t.formCI.campoDescripcionIngreso.invalid&&(t.formCI.campoDescripcionIngreso.dirty||t.formCI.campoDescripcionIngreso.touched))),e.xp6(3),e.Q6J("ngIf",null==t.formCI.campoDescripcionIngreso.errors?null:t.formCI.campoDescripcionIngreso.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.formCI.campoDescripcionIngreso.errors?null:t.formCI.campoDescripcionIngreso.errors.maxlength),e.xp6(4),e.Q6J("disabled",!t.formIngreso.valid)}}function ce(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Campo requerido. "),e.qZA())}function ge(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Ingrese solo n\xfameros. "),e.qZA())}function le(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Campo requerido. "),e.qZA())}function de(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," Campo requerido. "),e.qZA())}function ue(r,n){1&r&&(e.TgZ(0,"div"),e._uU(1," La descripci\xf3n debe ser menor a 50 caracteres. "),e.qZA())}function he(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",52),e.TgZ(1,"h5",53),e._uU(2,"Nuevo Egreso"),e.qZA(),e.TgZ(3,"button",54),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e.qZA(),e.qZA(),e.TgZ(4,"div",55),e.TgZ(5,"form",46),e.TgZ(6,"div",20),e.TgZ(7,"div",21),e.TgZ(8,"div",56),e.TgZ(9,"label",57),e._uU(10,"Monto"),e.qZA(),e._UZ(11,"input",58),e.TgZ(12,"div",59),e.YNc(13,ce,2,0,"div",60),e.YNc(14,ge,2,0,"div",60),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",21),e.TgZ(16,"div",56),e.TgZ(17,"label",57),e._uU(18,"M\xe9todo"),e.qZA(),e._UZ(19,"ng-select",61),e.TgZ(20,"div",59),e.YNc(21,le,2,0,"div",60),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(22,"div",20),e.TgZ(23,"div",15),e.TgZ(24,"div",56),e.TgZ(25,"label",57),e._uU(26,"Descripci\xf3n"),e.qZA(),e.TgZ(27,"textarea",62),e._uU(28,"            "),e.qZA(),e.TgZ(29,"div",59),e.YNc(30,de,2,0,"div",60),e.YNc(31,ue,2,0,"div",60),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"div",63),e.TgZ(33,"button",64),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e._uU(34," Cerrar "),e.qZA(),e.TgZ(35,"button",65),e.NdJ("click",function(){return e.CHM(t),e.oxw().guardarEgreso()}),e._uU(36," Guardar "),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("formGroup",t.formEgreso),e.xp6(6),e.s9C("formControlName",t.monto_egreso),e.Q6J("ngClass",e.VKq(14,I,t.formCE.campoMontoEgreso.invalid&&(t.formCE.campoMontoEgreso.dirty||t.formCE.campoMontoEgreso.touched))),e.xp6(2),e.Q6J("ngIf",null==t.formCE.campoMontoEgreso.errors?null:t.formCE.campoMontoEgreso.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.formCE.campoMontoEgreso.errors?null:t.formCE.campoMontoEgreso.errors.pattern),e.xp6(5),e.s9C("formControlName",t.metodoPagoContado_egreso),e.Q6J("items",t.listMetodosPagos)("ngClass",e.VKq(16,I,t.formCE.campoMetodoPagoContadoEgreso.invalid&&(t.formCE.campoMetodoPagoContadoEgreso.dirty||t.formCE.campoMetodoPagoContadoEgreso.touched))),e.xp6(2),e.Q6J("ngIf",null==t.formCE.campoMetodoPagoContadoEgreso.errors?null:t.formCE.campoMetodoPagoContadoEgreso.errors.required),e.xp6(6),e.s9C("formControlName",t.descripcion_egreso),e.Q6J("ngClass",e.VKq(18,I,t.formCE.campoDescripcionEgreso.invalid&&(t.formCE.campoDescripcionEgreso.dirty||t.formCE.campoDescripcionEgreso.touched))),e.xp6(3),e.Q6J("ngIf",null==t.formCE.campoDescripcionEgreso.errors?null:t.formCE.campoDescripcionEgreso.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.formCE.campoDescripcionEgreso.errors?null:t.formCE.campoDescripcionEgreso.errors.maxlength),e.xp6(4),e.Q6J("disabled",!t.formEgreso.valid)}}let _e=(()=>{class r{constructor(t,o,s,i,a,c){this.serviceI=t,this.serviceE=o,this.modalService=s,this.formBuilder=i,this.cajaService=a,this.usuarioService=c,this.role="Admin",this.nombre_sedes="campoSede",this.idSede="",this.submitted=!1,this.monto_ingreso="campoMontoIngreso",this.fecha_ingreso="campoFechaIngreso",this.descripcion_ingreso="campoDescripcionIngreso",this.metodoPagoContado_ingreso="campoMetodoPagoContadoIngreso",this.monto_egreso="campoMontoEgreso",this.fecha_egreso="campoFechaEgreso",this.descripcion_egreso="campoDescripcionEgreso",this.metodoPagoContado_egreso="campoMetodoPagoContadoEgreso",this.listMetodosPagos=["F\xedsico","Yape","Plin","Interbancario"],this.exampleOptions={defaultDate:"",altInputClass:"form-control"},this.hideme=[],this.eFisico=0,this.eVirtual=0,this.iFisico=0,this.iVirtual=0,this.numberDecimalPattern=/^\d+(\.\d{1,2})?$/,this.caja=new C,this.ingresos$=t.ingreso$,this.total$=t.totalI$,this.egresos$=o.egresos$,this.totalE$=o.totalE$;let d=new Date(Date.now());d.setHours(0,0,1);let u=new Date(Date.now());u.setHours(23,59,0),this.cajaService.getEgresosbyDate(d,u,this.usuarioService.getSedebyUser()).subscribe(m=>{this.eFisico=0,this.eVirtual=0,this.egresoTotal=m.reduce((Z,j)=>Z+j.monto,0),m.forEach(Z=>{"F\xedsico"==Z.metodo_pago?this.eFisico+=Z.monto:this.eVirtual+=Z.monto})}),this.cajaService.getIngresosbyDate(d,u,this.usuarioService.getSedebyUser()).subscribe(m=>{this.iFisico=0,this.iVirtual=0,this.ingresoTotal=m.reduce((Z,j)=>Z+j.monto,0),m.forEach(Z=>{"F\xedsico"==Z.metodo_pago?this.iFisico+=Z.monto:this.iVirtual+=Z.monto})})}ngOnInit(){this.breadCrumbItems=[{label:"Caja"},{label:"Registro de Ingreso y Egreso",active:!0}],this.getListSedes(),this.crearFormulario(),this.selectedDate=(new Date).getDate(),this._fetchData()}getListSedes(){this.listSedes=JSON.parse(localStorage.getItem("sedes")),this.idSede=this.usuarioService.getSedebyUser()}crearFormulario(){this.formIngreso=this.formBuilder.group({[this.monto_ingreso]:[null,[g.kI.required,g.kI.pattern(this.numberDecimalPattern)]],[this.fecha_ingreso]:[],[this.descripcion_ingreso]:[null,[g.kI.required,g.kI.maxLength(50)]],[this.metodoPagoContado_ingreso]:[null,[g.kI.required]]}),this.formEgreso=this.formBuilder.group({[this.monto_egreso]:[null,[g.kI.required,g.kI.pattern(this.numberDecimalPattern)]],[this.fecha_egreso]:[],[this.descripcion_egreso]:[null,[g.kI.required,g.kI.maxLength(50)]],[this.metodoPagoContado_egreso]:[null,[g.kI.required]]}),this.formSedes=this.formBuilder.group({[this.nombre_sedes]:[this.idSede]})}_fetchData(){}onSortI({column:t,direction:o}){this.headers.forEach(s=>{s.sortable!==t&&(s.direction="")}),this.serviceI.sortColumnI=t,this.serviceI.sortDirectionI=o}onSortE({column:t,direction:o}){this.headers.forEach(s=>{s.sortable!==t&&(s.direction="")}),this.serviceE.sortColumnE=t,this.serviceE.sortDirectionE=o}fS(t){return this.formSedes.get(t)}changeSede(){this.idSede=this.fS(this.nombre_sedes).value,this.updateListIngresos(this.idSede),this.updateListEgresos(this.idSede)}centerModal(t){this.modalService.open(t,{centered:!0,windowClass:"modal-holder"})}deleteEventData(){this.editEvent.remove(),this.modalService.dismissAll()}closeEventModal(){this.modalService.dismissAll()}fI(t){return this.formIngreso.get(t)}fE(t){return this.formEgreso.get(t)}guardarIngreso(){this.formIngreso.valid&&(this.caja.monto=Number(this.fI(this.monto_ingreso).value),this.caja.fecha_creacion_caja=new Date(Date.now()),this.caja.encargado=this.usuarioService.getUser().id_usuario,this.caja.descripcion=this.fI(this.descripcion_ingreso).value,this.caja.id_sede=this.usuarioService.getSedebyUser(),this.caja.habilitado=!0,this.caja.egreso=!1,this.caja.metodo_pago=this.fI(this.metodoPagoContado_ingreso).value,(0,T.H)("loading","Cargando..."),this.cajaService.createIngresoEgreso(this.caja).subscribe(t=>{this.updateListIngresos(this.idSede),this.formIngreso.reset(),this.modalService.dismissAll(),(0,T.H)("close",null),(0,T.H)("success","Ingreso guardado")}))}guardarEgreso(){this.formEgreso.valid&&(this.caja.monto=Number(this.fE(this.monto_egreso).value),this.caja.fecha_creacion_caja=new Date(Date.now()),this.caja.encargado=this.usuarioService.getUser().id_usuario,this.caja.descripcion=this.fE(this.descripcion_egreso).value,this.caja.id_sede=this.usuarioService.getSedebyUser(),this.caja.habilitado=!0,this.caja.egreso=!0,this.caja.metodo_pago=this.fE(this.metodoPagoContado_egreso).value,(0,T.H)("loading","Cargando..."),this.cajaService.createIngresoEgreso(this.caja).subscribe(t=>{this.formEgreso.reset(),this.modalService.dismissAll(),this.updateListEgresos(this.idSede),(0,T.H)("close",null),(0,T.H)("success","Egreso guardado")}))}eliminarIngreso(t){L().fire({title:"\xbfEst\xe1 seguro que desea eliminar?",text:"No se podr\xe1 revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Si, eliminar!"}).then(o=>{o.value?((0,T.H)("loading","Cargando..."),this.cajaService.deleteIngresoEgreso(t).subscribe(s=>{t.egreso?((0,T.H)("close",null),(0,T.H)("success","Egreso eliminado"),this.updateListEgresos(this.idSede)):((0,T.H)("close",null),(0,T.H)("success","Ingreso eliminado"),this.updateListIngresos(this.idSede))},s=>{(0,T.H)("close",null),(0,T.H)("error","Error en la conexi\xf3n")})):o.dismiss===L().DismissReason.cancel&&L().fire("Cancelado","Movimiento no eliminado","error")})}updateListIngresos(t){let o=new Date(Date.now());o.setHours(0,0,1);let s=new Date(Date.now());s.setHours(23,59,0),this.cajaService.getIngresosbyDate(o,s,t).subscribe(i=>{this.serviceI.updateTableIngreso(i),this.ingresoTotal=0,this.iFisico=0,this.iVirtual=0,this.ingresoTotal=i.reduce((a,c)=>a+c.monto,0),i.forEach(a=>{"F\xedsico"==a.metodo_pago?this.iFisico+=a.monto:this.iVirtual+=a.monto})})}updateListEgresos(t){let o=new Date(Date.now());o.setHours(0,0,1);let s=new Date(Date.now());s.setHours(23,59,0),this.cajaService.getEgresosbyDate(o,s,t).subscribe(i=>{this.serviceE.updateTableEgreso(i),this.egresoTotal=0,this.eFisico=0,this.eVirtual=0,this.egresoTotal=i.reduce((a,c)=>a+c.monto,0),i.forEach(a=>{"F\xedsico"==a.metodo_pago?this.eFisico+=a.monto:this.eVirtual+=a.monto})})}get formCI(){return this.formIngreso.controls}get formCE(){return this.formEgreso.controls}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(Q),e.Y36($),e.Y36(p.FF),e.Y36(g.qu),e.Y36(J),e.Y36(M.i))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-cash-register"]],viewQuery:function(t,o){if(1&t&&e.Gf(v,5),2&t){let s;e.iGM(s=e.CRH())&&(o.headers=s)}},features:[e._Bn([Q,$,h.JJ])],decls:150,vars:60,consts:[[1,"container-fluid"],["title","Caja de Registro",3,"breadcrumbItems"],[1,"row","mt-2","mb-2"],[1,"col-12","col-md-3","d-grid","text-center","mb-2"],["type","button",1,"btn","btn-primary","btn-block",3,"click"],[1,"uil","uil-arrow-growth","me-2"],["type","button",1,"btn","btn-danger","btn-block",3,"click"],[1,"uil","uil-chart-down","me-2"],[1,"col-12","col-md-3","d-grid"],["class","col-12 col-md-3 d-grid",4,"appRole"],[1,"row","mb-3"],[1,"col-lg-6"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],[1,"col-12"],[1,"mt-0"],[1,"text-center"],[1,"text-success","me-1"],[1,"mdi","mdi-arrow-up-bold","me-1"],[1,"row"],[1,"col-6"],[1,"row","mb-md-2"],[1,"col-12","text-md-end"],[1,"dataTables_length"],[1,"d-inline-flex","align-items-center"],["name","pageSize",1,"custom-select","custom-select-sm","form-control","form-control-sm","form-select","form-select-sm",3,"ngModel","ngModelChange"],[3,"ngValue"],[1,"table-responsive","mb-4"],["id","DataTables_Table_0_wrapper",1,"dataTables_wrapper","dt-bootstrap4","no-footer"],[1,"table","table-centered","dt-responsive","nowrap","table-card-list",2,"border-spacing","0 12px","width","100%"],[1,"table-light"],[1,"bg-transparent"],["scope","col","sortable","amount",3,"sort"],["scope","col","sortable","type",3,"sort"],["scope","col","sortable","description",3,"sort"],["scope","col","sortable","date",3,"sort"],["scope","col","sortable","name",3,"sort"],[4,"ngFor","ngForOf"],[1,"row","justify-content-md-between","align-items-md-center"],[1,"text-md-end","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","maxSize","rotate","boundaryLinks","pageChange"],[1,"text-danger","me-1"],[1,"mdi","mdi-arrow-down-bold","me-1"],["centerDataModalIngreso",""],["centerDataModalEgreso",""],[3,"formGroup"],["ngbDropdown",""],["placeholder","Seleccione la sede","bindValue","id_sede","bindLabel","nombre_sede",3,"items","formControlName","change"],[3,"result","term"],["placement","top","ngbTooltip","Delete",1,"px-3","text-danger",3,"click"],[1,"uil","uil-trash-alt","font-size-18"],[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","p-4"],[1,"mb-3"],[1,"control-label"],["placeholder","Ingrese el monto","type","text","name","title",1,"form-control",3,"formControlName","ngClass"],[1,"invalid-feedback"],[4,"ngIf"],["name","selectMetodo","placeholder","Seleccione",3,"items","formControlName","ngClass"],["id","billing-observaciones","rows","3","placeholder","Ingrese la descripci\xf3n",1,"form-control",3,"formControlName","ngClass"],[1,"text-end","mt-2"],["type","button",1,"btn","btn-danger",3,"click"],["type","submit","id","btn-save-event",1,"btn","btn-success","ms-1",3,"disabled","click"]],template:function(t,o){if(1&t){const s=e.EpF();e.TgZ(0,"div",0),e._UZ(1,"app-page-title",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"button",4),e.NdJ("click",function(){e.CHM(s);const a=e.MAs(147);return o.centerModal(a)}),e._UZ(5,"i",5),e._uU(6," Registar Ingreso "),e.qZA(),e.qZA(),e.TgZ(7,"div",3),e.TgZ(8,"button",6),e.NdJ("click",function(){e.CHM(s);const a=e.MAs(149);return o.centerModal(a)}),e._UZ(9,"i",7),e._uU(10,"Registar Egreso "),e.qZA(),e.qZA(),e._UZ(11,"div",8),e.YNc(12,W,4,3,"div",9),e.qZA(),e.TgZ(13,"div",10),e.TgZ(14,"div",11),e.TgZ(15,"div",12),e.TgZ(16,"div",13),e.TgZ(17,"div",14),e.TgZ(18,"div",15),e.TgZ(19,"div",16),e.TgZ(20,"h3",17),e._uU(21,"Ingreso Total: "),e.TgZ(22,"span",18),e._UZ(23,"i",19),e._uU(24),e.ALo(25,"currency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(26,"div",20),e.TgZ(27,"div",21),e.TgZ(28,"h5",17),e._uU(29),e.ALo(30,"currency"),e.qZA(),e.qZA(),e.TgZ(31,"div",21),e.TgZ(32,"h5",17),e._uU(33),e.ALo(34,"currency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(35,"div",12),e.TgZ(36,"div",13),e.TgZ(37,"div",22),e.TgZ(38,"div",23),e.TgZ(39,"div",24),e.TgZ(40,"label",25),e._uU(41,"Mostrar"),e.TgZ(42,"select",26),e.NdJ("ngModelChange",function(a){return o.serviceI.pageSizeI=a}),e.TgZ(43,"option",27),e._uU(44,"5"),e.qZA(),e.TgZ(45,"option",27),e._uU(46,"10"),e.qZA(),e.TgZ(47,"option",27),e._uU(48,"25"),e.qZA(),e.TgZ(49,"option",27),e._uU(50,"50"),e.qZA(),e.TgZ(51,"option",27),e._uU(52,"100"),e.qZA(),e.qZA(),e._uU(53," entradas"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(54,"div",28),e.TgZ(55,"div",29),e.TgZ(56,"form"),e.TgZ(57,"table",30),e.TgZ(58,"thead",31),e.TgZ(59,"tr",32),e.TgZ(60,"th",33),e.NdJ("sort",function(a){return o.onSortI(a)}),e._uU(61,"Monto"),e.qZA(),e.TgZ(62,"th",34),e.NdJ("sort",function(a){return o.onSortI(a)}),e._uU(63,"M\xe9todo"),e.qZA(),e.TgZ(64,"th",35),e.NdJ("sort",function(a){return o.onSortI(a)}),e._uU(65,"Descripci\xf3n"),e.qZA(),e.TgZ(66,"th",36),e.NdJ("sort",function(a){return o.onSortI(a)}),e._uU(67,"Fecha"),e.qZA(),e.TgZ(68,"th",37),e.NdJ("sort",function(a){return o.onSortI(a)}),e._uU(69,"Usuario"),e.qZA(),e.TgZ(70,"th"),e._uU(71,"Action"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(72,"tbody"),e.YNc(73,ee,15,13,"tr",38),e.ALo(74,"async"),e.qZA(),e.qZA(),e.TgZ(75,"div",39),e.TgZ(76,"div",15),e.TgZ(77,"div",40),e.TgZ(78,"ngb-pagination",41),e.NdJ("pageChange",function(a){return o.serviceI.pageI=a}),e.ALo(79,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(80,"div",11),e.TgZ(81,"div",12),e.TgZ(82,"div",13),e.TgZ(83,"div",14),e.TgZ(84,"div",15),e.TgZ(85,"div",16),e.TgZ(86,"h3",17),e._uU(87,"Egreso Total: "),e.TgZ(88,"span",42),e._UZ(89,"i",43),e._uU(90),e.ALo(91,"currency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(92,"div",20),e.TgZ(93,"div",21),e.TgZ(94,"h5",17),e._uU(95),e.ALo(96,"currency"),e.qZA(),e.qZA(),e.TgZ(97,"div",21),e.TgZ(98,"h5",17),e._uU(99),e.ALo(100,"currency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(101,"div",12),e.TgZ(102,"div",13),e.TgZ(103,"div",22),e.TgZ(104,"div",23),e.TgZ(105,"div",24),e.TgZ(106,"label",25),e._uU(107,"Mostrar"),e.TgZ(108,"select",26),e.NdJ("ngModelChange",function(a){return o.serviceE.pageSizeE=a}),e.TgZ(109,"option",27),e._uU(110,"5"),e.qZA(),e.TgZ(111,"option",27),e._uU(112,"10"),e.qZA(),e.TgZ(113,"option",27),e._uU(114,"25"),e.qZA(),e.TgZ(115,"option",27),e._uU(116,"50"),e.qZA(),e.TgZ(117,"option",27),e._uU(118,"100"),e.qZA(),e.qZA(),e._uU(119," entradas"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(120,"div",28),e.TgZ(121,"div",29),e.TgZ(122,"form"),e.TgZ(123,"table",30),e.TgZ(124,"thead",31),e.TgZ(125,"tr",32),e.TgZ(126,"th",33),e.NdJ("sort",function(a){return o.onSortE(a)}),e._uU(127,"Monto"),e.qZA(),e.TgZ(128,"th",34),e.NdJ("sort",function(a){return o.onSortE(a)}),e._uU(129,"M\xe9todo"),e.qZA(),e.TgZ(130,"th",35),e.NdJ("sort",function(a){return o.onSortE(a)}),e._uU(131,"Descripci\xf3n"),e.qZA(),e.TgZ(132,"th",36),e.NdJ("sort",function(a){return o.onSortE(a)}),e._uU(133,"Fecha"),e.qZA(),e.TgZ(134,"th",37),e.NdJ("sort",function(a){return o.onSortE(a)}),e._uU(135,"Usuario"),e.qZA(),e.TgZ(136,"th"),e._uU(137,"Action"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(138,"tbody"),e.YNc(139,te,15,13,"tr",38),e.ALo(140,"async"),e.qZA(),e.qZA(),e.TgZ(141,"div",39),e.TgZ(142,"div",15),e.TgZ(143,"div",40),e.TgZ(144,"ngb-pagination",41),e.NdJ("pageChange",function(a){return o.serviceE.pageE=a}),e.ALo(145,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(146,ae,37,20,"ng-template",null,44,e.W1O),e.YNc(148,he,37,20,"ng-template",null,45,e.W1O)}2&t&&(e.xp6(1),e.Q6J("breadcrumbItems",o.breadCrumbItems),e.xp6(11),e.Q6J("appRole",o.role),e.xp6(12),e.Oqu(e.xi3(25,34,o.ingresoTotal,"S/ ")),e.xp6(5),e.hij("F\xedsico: ",e.xi3(30,37,o.iFisico,"S/ "),""),e.xp6(4),e.hij("Virtual: ",e.xi3(34,40,o.iVirtual,"S/ "),""),e.xp6(9),e.Q6J("ngModel",o.serviceI.pageSizeI),e.xp6(1),e.Q6J("ngValue",5),e.xp6(2),e.Q6J("ngValue",10),e.xp6(2),e.Q6J("ngValue",25),e.xp6(2),e.Q6J("ngValue",50),e.xp6(2),e.Q6J("ngValue",100),e.xp6(22),e.Q6J("ngForOf",e.lcZ(74,43,o.ingresos$)),e.xp6(5),e.Q6J("collectionSize",e.lcZ(79,45,o.total$))("page",o.serviceI.pageI)("pageSize",o.serviceI.pageSizeI)("maxSize",5)("rotate",!0)("boundaryLinks",!0),e.xp6(12),e.Oqu(e.xi3(91,47,o.egresoTotal,"S/ ")),e.xp6(5),e.hij("F\xedsico: ",e.xi3(96,50,o.eFisico,"S/ "),""),e.xp6(4),e.hij("Virtual: ",e.xi3(100,53,o.eVirtual,"S/ "),""),e.xp6(9),e.Q6J("ngModel",o.serviceE.pageSizeE),e.xp6(1),e.Q6J("ngValue",5),e.xp6(2),e.Q6J("ngValue",10),e.xp6(2),e.Q6J("ngValue",25),e.xp6(2),e.Q6J("ngValue",50),e.xp6(2),e.Q6J("ngValue",100),e.xp6(22),e.Q6J("ngForOf",e.lcZ(140,56,o.egresos$)),e.xp6(5),e.Q6J("collectionSize",e.lcZ(145,58,o.totalE$))("page",o.serviceE.pageE)("pageSize",o.serviceE.pageSizeE)("maxSize",5)("rotate",!0)("boundaryLinks",!0))},directives:[H.V,K.g,g.EJ,g.JJ,g.On,g.YN,g.Kr,g._Y,g.JL,g.F,h.sg,p.N9,g.sg,p.jt,N.w9,g.u,p._h,p._L,g.Fj,h.mk,h.O5],pipes:[h.H9,h.Ov],styles:[""]}),r})(),R=(()=>{class r{constructor(t,o,s){this.pipe=t,this.cajaService=o,this.usuarioService=s,this._loading$=new _.X(!0),this._search$=new E.xQ,this._transactions$=new _.X([]),this._total$=new _.X(0),this._state={page:1,pageSize:10,searchTerm:"",sortColumn:"",sortDirection:""};let i=new Date,a=new Date(i.getFullYear(),i.getMonth(),1),c=new Date(i.getFullYear(),i.getMonth()+1,0);a.setHours(0,0,1),c.setHours(23,59,0),this.getListIngresosEgresos(a,c)}updateTable(t){this._transactions$.next(t)}get transactions$(){return this._transactions$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get page(){return this._state.page}get pageSize(){return this._state.pageSize}get searchTerm(){return this._state.searchTerm}set page(t){this._set({page:t})}set pageSize(t){this._set({pageSize:t})}set searchTerm(t){this._set({searchTerm:t})}set sortColumn(t){this._set({sortColumn:t})}set sortDirection(t){this._set({sortDirection:t})}_set(t){Object.assign(this._state,t),this._search$.next()}_search(){const{sortColumn:t,sortDirection:o,pageSize:s,page:i,searchTerm:a}=this._state;let c=function(r,n,t){return""===t||""===n?r:[...r].sort((o,s)=>{const i=((r,n)=>r<n?-1:r>n?1:0)(o[n],s[n]);return"asc"===t?i:-i})}(this.cajaList,t,o);c=c.filter(u=>function(r,n,t){return r.date.toLowerCase().includes(n)}(u,a));const d=c.length;return c=c.slice((i-1)*s,(i-1)*s+s),(0,U.of)({transactions:c,total:d})}getListIngresosEgresos(t,o){this.cajaService.getIngresosEgresosbyMonth(t,o,this.usuarioService.getSedebyUser()).subscribe(s=>{const i=s.reduce((c,d)=>{const u=d.fecha_creacion_caja.split(" ")[0];return c[u]||(c[u]=[]),c[u].push(d),c},{}),a=Object.keys(i).map(c=>({date:c,caja:i[c]}));a.forEach(c=>{const d={ingreso_total:0,egreso_total:0};c.caja.reduce((u,m)=>{m.egreso?d.egreso_total=u+m.monto:d.ingreso_total=u+m.monto},0),Object.assign(c,d)}),this.cajaList=a,this._search$.pipe((0,S.b)(()=>this._loading$.next(!0)),(0,y.b)(200),(0,w.w)(()=>this._search()),(0,D.g)(200),(0,S.b)(()=>this._loading$.next(!1))).subscribe(c=>{this._transactions$.next(c.transactions),this._total$.next(c.total)}),this._search$.next()})}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(h.JJ),e.LFG(J),e.LFG(M.i))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const Te={asc:"desc",desc:"","":"asc"};let fe=(()=>{class r{constructor(){this.sortable="",this.direction="",this.sort=new e.vpe}rotate(){this.direction=Te[this.direction],this.sort.emit({column:this.sortable,direction:this.direction})}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=e.lG2({type:r,selectors:[["th","sortable",""]],hostVars:4,hostBindings:function(t,o){1&t&&e.NdJ("click",function(){return o.rotate()}),2&t&&e.ekj("asc","asc"===o.direction)("desc","desc"===o.direction)},inputs:{sortable:"sortable",direction:"direction"},outputs:{sort:"sort"}}),r})();class Ce{constructor(){this.ingresos_fisicos=0,this.ingresos_virtuales=0,this.egresos_fisicos=0,this.egresos_virtuales=0}}var ve=l(4680);const Ae=function(r){return{"bg-soft-danger":r}};function be(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr",41),e.TgZ(1,"td"),e._UZ(2,"ngb-highlight",42),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"ngb-highlight",42),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"ngb-highlight",42),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"td"),e._UZ(9,"ngb-highlight",42),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"td"),e.TgZ(12,"span",43),e._uU(13),e.ALo(14,"currency"),e.qZA(),e.qZA(),e.TgZ(15,"td"),e.TgZ(16,"a",44),e.NdJ("click",function(){const i=e.CHM(t).$implicit,a=e.oxw(),c=e.MAs(67);return a.scrollModal(c,i)}),e._UZ(17,"i",45),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=n.$implicit,o=n.index,s=e.oxw();e.xp6(2),e.Q6J("result",o+1)("term",s.service.searchTerm),e.xp6(2),e.Q6J("result",t.date)("term",s.service.searchTerm),e.xp6(2),e.Q6J("result",e.xi3(7,10,t.ingreso_total,"S/ "))("term",s.service.searchTerm),e.xp6(3),e.Q6J("result",e.xi3(10,13,t.egreso_total,"S/ "))("term",s.service.searchTerm),e.xp6(3),e.Q6J("ngClass",e.VKq(19,Ae,t.ingreso_total-t.egreso_total<0)),e.xp6(1),e.hij(" ",e.xi3(14,16,t.ingreso_total-t.egreso_total,"S/ ")," ")}}function qe(r,n){if(1&r&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"ngb-highlight",42),e.ALo(3,"currency"),e.qZA(),e.TgZ(4,"td"),e._UZ(5,"ngb-highlight",42),e.qZA(),e.TgZ(6,"td"),e._UZ(7,"ngb-highlight",42),e.qZA(),e.TgZ(8,"td"),e._UZ(9,"ngb-highlight",42),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"ngb-highlight",42),e.qZA(),e.qZA()),2&r){const t=n.$implicit;e.xp6(2),e.Q6J("result",e.xi3(3,4,t.monto,"S/.")),e.xp6(3),e.Q6J("result",t.metodo_pago),e.xp6(2),e.Q6J("result",t.descripcion),e.xp6(2),e.Q6J("result",e.xi3(10,7,t.fecha_creacion_caja,"dd/MM/yyyy"))}}function xe(r,n){if(1&r&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"ngb-highlight",42),e.ALo(3,"currency"),e.qZA(),e.TgZ(4,"td"),e._UZ(5,"ngb-highlight",42),e.qZA(),e.TgZ(6,"td"),e._UZ(7,"ngb-highlight",42),e.qZA(),e.TgZ(8,"td"),e._UZ(9,"ngb-highlight",42),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"ngb-highlight",42),e.qZA(),e.qZA()),2&r){const t=n.$implicit;e.xp6(2),e.Q6J("result",e.xi3(3,4,t.monto,"S/.")),e.xp6(3),e.Q6J("result",t.metodo_pago),e.xp6(2),e.Q6J("result",t.descripcion),e.xp6(2),e.Q6J("result",e.xi3(10,7,t.fecha_creacion_caja,"dd/MM/yyyy"))}}function Se(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",46),e.TgZ(1,"h5",47),e._uU(2),e.qZA(),e.TgZ(3,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModalGeneral()}),e.qZA(),e.qZA(),e.TgZ(4,"div",49),e.TgZ(5,"div",2),e.TgZ(6,"div",25),e.TgZ(7,"div",50),e.TgZ(8,"div",51),e.TgZ(9,"div",52),e.TgZ(10,"div",53),e.TgZ(11,"div",2),e.TgZ(12,"div",54),e.TgZ(13,"div",55),e.TgZ(14,"p",56),e._uU(15,"Ingreso"),e.qZA(),e.TgZ(16,"h4",57),e.TgZ(17,"span",58),e._UZ(18,"i",59),e._uU(19),e.ALo(20,"currency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",54),e.TgZ(22,"div",55),e.TgZ(23,"p",56),e._uU(24,"Egreso"),e.qZA(),e.TgZ(25,"h4",57),e.TgZ(26,"span",60),e._UZ(27,"i",61),e._uU(28),e.ALo(29,"currency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",62),e.TgZ(31,"div",63),e.TgZ(32,"div",2),e.TgZ(33,"div",54),e.TgZ(34,"h6"),e._uU(35),e.ALo(36,"currency"),e.qZA(),e.qZA(),e.TgZ(37,"div",54),e.TgZ(38,"h6"),e._uU(39),e.ALo(40,"currency"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(41,"div",26),e.TgZ(42,"div",27),e.TgZ(43,"form"),e.TgZ(44,"table",64),e.TgZ(45,"thead",65),e.TgZ(46,"tr",29),e.TgZ(47,"th",66),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSort(s)}),e._uU(48,"Monto"),e.qZA(),e.TgZ(49,"th",67),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSort(s)}),e._uU(50,"M\xe9todo"),e.qZA(),e.TgZ(51,"th",68),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSort(s)}),e._uU(52,"Descripci\xf3n"),e.qZA(),e.TgZ(53,"th",69),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSort(s)}),e._uU(54,"Fecha"),e.qZA(),e.TgZ(55,"th",70),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSort(s)}),e._uU(56,"Usuario"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(57,"tbody"),e.YNc(58,qe,13,10,"tr",71),e.qZA(),e.qZA(),e._UZ(59,"div",37),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(60,"div",62),e.TgZ(61,"div",63),e.TgZ(62,"div",2),e.TgZ(63,"div",54),e.TgZ(64,"h6"),e._uU(65),e.ALo(66,"currency"),e.qZA(),e.qZA(),e.TgZ(67,"div",54),e.TgZ(68,"h6"),e._uU(69),e.ALo(70,"currency"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(71,"div",26),e.TgZ(72,"div",27),e.TgZ(73,"form"),e.TgZ(74,"table",64),e.TgZ(75,"thead",65),e.TgZ(76,"tr",29),e.TgZ(77,"th",66),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSortE(s)}),e._uU(78,"Monto"),e.qZA(),e.TgZ(79,"th",67),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSort(s)}),e._uU(80,"M\xe9todo"),e.qZA(),e.TgZ(81,"th",68),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSortE(s)}),e._uU(82,"Descripci\xf3n"),e.qZA(),e.TgZ(83,"th",69),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSortE(s)}),e._uU(84,"Fecha"),e.qZA(),e.TgZ(85,"th",70),e.NdJ("sort",function(s){return e.CHM(t),e.oxw().onSortE(s)}),e._uU(86,"Usuario"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(87,"tbody"),e.YNc(88,xe,13,10,"tr",71),e.qZA(),e.qZA(),e._UZ(89,"div",37),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(90,"div",72),e.TgZ(91,"button",73),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModalGeneral()}),e._uU(92,"Cerrar"),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(2),e.hij("Detalle de Caja: ",t.reporteCaja.fechaCaja,""),e.xp6(17),e.Oqu(e.xi3(20,9,t.reporteCaja.ingreso_total,"S/ ")),e.xp6(9),e.Oqu(e.xi3(29,12,t.reporteCaja.egreso_total,"S/ ")),e.xp6(7),e.hij("Ingresos F\xedsico: ",e.xi3(36,15,t.reporteCaja.ingresos_fisicos,"S/ "),""),e.xp6(4),e.hij("Ingresos Virtual: ",e.xi3(40,18,t.reporteCaja.ingresos_virtuales,"S/ "),""),e.xp6(19),e.Q6J("ngForOf",t.reporteCaja.ingresos),e.xp6(7),e.hij("Egresos F\xedsico: ",e.xi3(66,21,t.reporteCaja.egresos_fisicos,"S/ "),""),e.xp6(4),e.hij("Egresos Virtual: ",e.xi3(70,24,t.reporteCaja.egresos_virtuales,"S/ "),""),e.xp6(19),e.Q6J("ngForOf",t.reporteCaja.egresos)}}const Ee=[{path:"cashregister",component:_e,data:{role:["Vendedor","Admin"]},canActivate:[x.a]},{path:"listcash",component:(()=>{class r{constructor(t,o,s,i,a){this.modalService=t,this.service=o,this.fb=s,this.usuarioService=i,this.cajaService=a,this.nombre_sedes="campoSede",this.idSede="",this.fechaDesde="campoFechaDesde",this.fechaHasta="campoFechaHasta",this.reporteCaja=new Ce,this.transactions$=o.transactions$,this.total$=o.total$}ngOnInit(){this.breadCrumbItems=[{label:"Caja"},{label:"Lista de Ingresos y Egresos",active:!0}],this.getListSedes(),this.crearFormulario()}getListSedes(){this.listSedes=JSON.parse(localStorage.getItem("sedes")),this.idSede=this.usuarioService.getSedebyUser()}crearFormulario(){this.formSedes=this.fb.group({[this.nombre_sedes]:[this.idSede]}),this.formDateRange=this.fb.group({[this.fechaDesde]:[(0,ve.fh)(new Date(Date.now()))]})}onSort({column:t,direction:o}){this.headers.forEach(s=>{s.sortable!==t&&(s.direction="")}),this.service.sortColumn=t,this.service.sortDirection=o}scrollModal(t,o){this.reporteCaja.fechaCaja=new Date(o.date+"T00:00").toLocaleDateString("en-GB"),this.reporteCaja.ingreso_total=o.ingreso_total,this.reporteCaja.egreso_total=o.egreso_total,this.reporteCaja.ingresos=o.caja.filter(s=>0==s.egreso),this.reporteCaja.egresos=o.caja.filter(s=>1==s.egreso),this.reporteCaja.ingresos.reduce((s,i)=>{"F\xedsico"==i.metodo_pago?this.reporteCaja.ingresos_fisicos=s+i.monto:this.reporteCaja.ingresos_virtuales=s+i.monto},0),this.reporteCaja.egresos.reduce((s,i)=>{"F\xedsico"==i.metodo_pago?this.reporteCaja.egresos_fisicos=s+i.monto:this.reporteCaja.egresos_virtuales=s+i.monto},0),this.modalService.open(t,{size:"lg",centered:!0,scrollable:!0})}closeEventModalGeneral(){this.modalService.dismissAll()}f(t){return this.formDateRange.get(t)}filterDateRange(){if(this.formDateRange.valid){let t=new Date(this.f(this.fechaDesde).value+"T00:00"),o=new Date(t.getFullYear(),t.getMonth(),1),s=new Date(t.getFullYear(),t.getMonth()+1,0);o.setHours(0,0,1),s.setHours(23,59,0),this.updateListCaja(o,s,this.idSede)}}fS(t){return this.formSedes.get(t)}changeSedes(){this.idSede=this.fS(this.nombre_sedes).value;const t=new Date(this.f(this.fechaDesde).value+"T00:00");let o=new Date(t.getFullYear(),t.getMonth(),1),s=new Date(t.getFullYear(),t.getMonth()+1,0);o.setHours(0,0,1),s.setHours(23,59,0),this.updateListCaja(o,s,this.idSede)}updateListCaja(t,o,s){this.cajaService.getIngresosEgresosbyMonth(t,o,s).subscribe(i=>{const a=i.reduce((d,u)=>{const m=u.fecha_creacion_caja.split(" ")[0];return d[m]||(d[m]=[]),d[m].push(u),d},{}),c=Object.keys(a).map(d=>({date:d,caja:a[d]}));c.forEach(d=>{const u={ingreso_total:0,egreso_total:0};d.caja.reduce((m,Z)=>{Z.egreso?u.egreso_total=m+Z.monto:u.ingreso_total=m+Z.monto},0),Object.assign(d,u)}),this.service.updateTable(c)})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.FF),e.Y36(R),e.Y36(g.qu),e.Y36(M.i),e.Y36(J))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-list-cash"]],viewQuery:function(t,o){if(1&t&&e.Gf(fe,5),2&t){let s;e.iGM(s=e.CRH())&&(o.headers=s)}},features:[e._Bn([R,h.JJ])],decls:68,vars:23,consts:[[1,"container-fluid"],["title","Listas de Registro de Ingresos y Egresos",3,"breadcrumbItems"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-inline"],[1,"search-box","ml-2"],[1,"position-relative"],["type","text","placeholder","Buscar registro","name","searchTerm","aria-controls","tickets-table",1,"form-control","border-light","rounded",3,"ngModel","ngModelChange"],[1,"uil","uil-search","search-icon"],["role","toolbar",1,"btn-toolbar"],[1,"col-12","col-md-6","d-grid","mb-2","chat-search-box","px-1"],[3,"formGroup"],[1,"input-daterange","input-group"],["type","month","id","billing-fechanacimiento","placeholder","Seleccione la fecha",1,"form-control",3,"formControlName"],["type","button",1,"btn","btn-primary",3,"click"],[1,"mdi","mdi-filter-variant"],[1,"col-12","col-md-6","d-grid"],["ngbDropdown",""],["placeholder","Seleccione la sede","bindValue","id_sede","bindLabel","nombre_sede",3,"items","formControlName","change"],[1,"row","md-2"],[1,"col-sm-12","col-md-12"],[1,"dataTables_length","text-md-end"],[1,"d-inline-flex","align-items-center"],["name","pageSize",1,"custom-select","custom-select-sm","form-control","form-control-sm","form-select","form-select-sm",3,"ngModel","ngModelChange"],[3,"ngValue"],[1,"col-12"],[1,"table-responsive","mb-4"],["id","DataTables_Table_0_wrapper",1,"dataTables_wrapper","dt-bootstrap4","no-footer"],[1,"table","table-centered","datatables","dt-responsive","nowrap","table-card-list",2,"border-spacing","0 12px","width","100%"],[1,"bg-transparent"],["scope","col","sortable","id",3,"sort"],["scope","col","sortable","fecha",3,"sort"],["scope","col","sortable","ingreso",3,"sort"],["scope","col","sortable","egreso",3,"sort"],["scope","col","sortable","status",3,"sort"],[2,"width","170px"],["class","odd",4,"ngFor","ngForOf"],[1,"row","justify-content-md-between","align-items-md-center"],[1,"text-md-end","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","maxSize","rotate","boundaryLinks","pageChange"],["scrollDataModalDetalleCajaDia",""],[1,"odd"],[3,"result","term"],[1,"badge","rounded-pill","bg-soft-success","font-size-12",3,"ngClass"],["placement","top","ngbTooltip","Ver detalle",1,"px-3","text-primary",3,"click"],[1,"uil","uil-eye","font-size-18"],[1,"modal-header"],[1,"modal-title","mt-0"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"card"],[1,"card-body"],[1,"d-flex","align-items-start"],[1,"flex-1","align-self-center"],[1,"col-6"],[1,"mt-1"],[1,"text-muted","mb-2"],[1,"text-muted","mt-3","mb-0"],[1,"text-success","me-1"],[1,"mdi","mdi-arrow-up-bold","me-1"],[1,"text-danger","me-1"],[1,"mdi","mdi-arrow-down-bold","me-1"],[1,"row","mb-3"],[1,"col-lg-12"],[1,"table","table-centered","dt-responsive","nowrap","table-card-list",2,"border-spacing","0 12px","width","100%"],[1,"table-light"],["scope","col","sortable","amount",3,"sort"],["scope","col","sortable","type",3,"sort"],["scope","col","sortable","description",3,"sort"],["scope","col","sortable","date",3,"sort"],["scope","col","sortable","name",3,"sort"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-page-title",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"div",6),e.TgZ(7,"input",7),e.NdJ("ngModelChange",function(i){return o.service.searchTerm=i}),e.qZA(),e._UZ(8,"i",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",3),e.TgZ(10,"div"),e.TgZ(11,"div",9),e.TgZ(12,"div",10),e.TgZ(13,"div",6),e.TgZ(14,"form",11),e.TgZ(15,"div",12),e._UZ(16,"input",13),e.TgZ(17,"button",14),e.NdJ("click",function(){return o.filterDateRange()}),e._UZ(18,"i",15),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",16),e.TgZ(20,"form",11),e.TgZ(21,"div",17),e.TgZ(22,"ng-select",18),e.NdJ("change",function(){return o.changeSedes()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",19),e.TgZ(24,"div",20),e.TgZ(25,"div",21),e.TgZ(26,"label",22),e._uU(27,"Mostrar"),e.TgZ(28,"select",23),e.NdJ("ngModelChange",function(i){return o.service.pageSize=i}),e.TgZ(29,"option",24),e._uU(30,"10"),e.qZA(),e.TgZ(31,"option",24),e._uU(32,"25"),e.qZA(),e.TgZ(33,"option",24),e._uU(34,"50"),e.qZA(),e.TgZ(35,"option",24),e._uU(36,"100"),e.qZA(),e.qZA(),e._uU(37," entradas"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"div",2),e.TgZ(39,"div",25),e.TgZ(40,"div",26),e.TgZ(41,"div",27),e.TgZ(42,"form"),e.TgZ(43,"table",28),e.TgZ(44,"thead"),e.TgZ(45,"tr",29),e.TgZ(46,"th",30),e.NdJ("sort",function(i){return o.onSort(i)}),e._uU(47,"Ord."),e.qZA(),e.TgZ(48,"th",31),e.NdJ("sort",function(i){return o.onSort(i)}),e._uU(49,"Fecha"),e.qZA(),e.TgZ(50,"th",32),e.NdJ("sort",function(i){return o.onSort(i)}),e._uU(51,"Ingreso"),e.qZA(),e.TgZ(52,"th",33),e.NdJ("sort",function(i){return o.onSort(i)}),e._uU(53,"Egreso"),e.qZA(),e.TgZ(54,"th",34),e.NdJ("sort",function(i){return o.onSort(i)}),e._uU(55,"Ganancia/P\xe9rdida"),e.qZA(),e.TgZ(56,"th",35),e._uU(57,"Action"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(58,"tbody"),e.YNc(59,be,18,21,"tr",36),e.ALo(60,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(61,"div",37),e.TgZ(62,"div",25),e.TgZ(63,"div",38),e.TgZ(64,"ngb-pagination",39),e.NdJ("pageChange",function(i){return o.service.page=i}),e.ALo(65,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(66,Se,93,27,"ng-template",null,40,e.W1O),e.qZA()),2&t&&(e.xp6(1),e.Q6J("breadcrumbItems",o.breadCrumbItems),e.xp6(6),e.Q6J("ngModel",o.service.searchTerm),e.xp6(7),e.Q6J("formGroup",o.formDateRange),e.xp6(2),e.s9C("formControlName",o.fechaDesde),e.xp6(4),e.Q6J("formGroup",o.formSedes),e.xp6(2),e.s9C("formControlName",o.nombre_sedes),e.Q6J("items",o.listSedes),e.xp6(6),e.Q6J("ngModel",o.service.pageSize),e.xp6(1),e.Q6J("ngValue",10),e.xp6(2),e.Q6J("ngValue",25),e.xp6(2),e.Q6J("ngValue",50),e.xp6(2),e.Q6J("ngValue",100),e.xp6(24),e.Q6J("ngForOf",e.lcZ(60,19,o.transactions$)),e.xp6(5),e.Q6J("collectionSize",e.lcZ(65,21,o.total$))("page",o.service.page)("pageSize",o.service.pageSize)("maxSize",5)("rotate",!0)("boundaryLinks",!0))},directives:[H.V,g.Fj,g.JJ,g.On,g._Y,g.JL,g.sg,g.u,p.jt,N.w9,g.EJ,g.YN,g.Kr,g.F,h.sg,p.N9,p._h,h.mk,p._L],pipes:[h.Ov,h.H9,h.uU],styles:[""]}),r})(),data:{role:["Admin"]},canActivate:[x.a]}];let Ue=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[f.Bz.forChild(Ee)],f.Bz]}),r})();var Je=l(63091),Me=l(98816),ye=l(16541),k=l(41867),we=l(5426),De=l(2974);let Le=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[{provide:k._t,useValue:we.v}],imports:[[h.ez,g.u5,g.UX,Ue,Je.v,k.Ti,p.HK,p.XC,p.jF,N.A0,Me.h,ye.bt,p.Gs,p.ZS,p.lQ,De.o]]}),r})()},4680:(F,q,l)=>{function h(e){return new Promise((A,v)=>{var C=new Image;C.setAttribute("crossOrigin","anonymous"),C.onload=()=>{var _=document.createElement("canvas");_.width=C.width,_.height=C.height,_.getContext("2d").drawImage(C,0,0);var U=_.toDataURL("image/png");A(U)},C.onerror=_=>{v(_)},C.src=e})}function g(e){const[A,v,C]=e.split("/");return new Date(+C,+v-1,+A)}function f(e,A){var v=Math.pow(10,A||0);return Math.round(e*v)/v}function x(e){return e.toISOString().substring(0,7)}l.d(q,{up:()=>h,p6:()=>g,NM:()=>f,fh:()=>x})}}]);