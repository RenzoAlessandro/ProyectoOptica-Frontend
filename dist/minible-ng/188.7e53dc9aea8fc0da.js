(self.webpackChunkminible_ng=self.webpackChunkminible_ng||[]).push([[188],{7082:function(Ze,I){!function(d){"use strict";var f="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},s={weekdays:{shorthand:["Dom","Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b"],longhand:["Domingo","Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"]},months:{shorthand:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],longhand:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]},ordinal:function(){return"\xba"},firstDayOfWeek:1,rangeSeparator:" a ",time_24hr:!0};f.l10ns.es=s;var m=f.l10ns;d.Spanish=s,d.default=m,Object.defineProperty(d,"__esModule",{value:!0})}(I)},12188:(Ze,I,d)=>{"use strict";d.r(I),d.d(I,{SaleModule:()=>jt});var f=d(86019),s=d(49133),m=d(20154),D=d(40345),X=d(98816),W=d(16541),ee=d(41867),fe=d(5426),ve=d(63091),te=d(56225),Y=d(85298),oe=d(64762),e=d(83668);const be={asc:"desc",desc:"","":"asc"};let Ce=(()=>{class i{constructor(){this.sortable="",this.direction="",this.sort=new e.vpe}rotate(){this.direction=be[this.direction],this.sort.emit({column:this.sortable,direction:this.direction})}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=e.lG2({type:i,selectors:[["th","sortable",""]],hostVars:4,hostBindings:function(t,o){1&t&&e.NdJ("click",function(){return o.rotate()}),2&t&&e.ekj("asc","asc"===o.direction)("desc","desc"===o.direction)},inputs:{sortable:"sortable",direction:"direction"},outputs:{sort:"sort"}}),i})();class ie{constructor(){this.list_monturas=[],this.list_lunas=[],this.list_accesorios=[],this.tipo_venta=[]}}class Ae{}var Te=d(1659),U=d.n(Te),_=d(63782),xe=d(54900),L=d.n(xe),ae=d(52653),y=d(4680),qe=d(91917),ne=d(95686),R=d(20566),$=d(11950),re=d(94774),j=d(48185);const Se=["autocomplete"];function Ne(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"a",42),e.NdJ("click",function(){e.CHM(t);const a=e.MAs(11);return e.oxw().copyText(a)}),e._UZ(3,"i",43),e.qZA(),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td",null,44),e._uU(12),e.qZA(),e.qZA()}if(2&i){const t=n.$implicit;e.xp6(5),e.hij(" ",t.material," "),e.xp6(2),e.hij(" ",t.marca," "),e.xp6(2),e.hij(" ",t.color," "),e.xp6(3),e.hij(" ",t.id_producto," ")}}function Ue(i,n){1&i&&e._UZ(0,"a",45),2&i&&e.Q6J("innerHTML",n.$implicit.id_producto,e.oJD)}function ye(i,n){1&i&&e._UZ(0,"div",45),2&i&&e.Q6J("innerHTML",n.$implicit,e.oJD)}function Pe(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",46),e.TgZ(1,"form",47),e.TgZ(2,"div",48),e.TgZ(3,"ng-select",49),e.NdJ("change",function(){return e.CHM(t),e.oxw().changeSede()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.formSedes),e.xp6(2),e.s9C("formControlName",t.nombre_sedes),e.Q6J("items",t.listSedes)}}function Me(i,n){if(1&i&&(e.TgZ(0,"td"),e._UZ(1,"ngb-highlight",50),e._uU(2,"\xa0 "),e._UZ(3,"ngb-highlight",50),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("result",t.material),e.xp6(2),e.Q6J("result",t.marca)}}function Je(i,n){if(1&i&&(e.TgZ(0,"td"),e._UZ(1,"ngb-highlight",50),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("result",t.material)}}function Ee(i,n){if(1&i&&(e.TgZ(0,"td"),e._UZ(1,"ngb-highlight",50),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("result",t.nombre_accesorio)}}function Ve(i,n){if(1&i&&(e.TgZ(0,"td"),e._UZ(1,"ngb-highlight",50),e.ALo(2,"currency"),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("result",e.xi3(2,1,t.precio_montura_v,"S/ "))}}function we(i,n){if(1&i&&(e.TgZ(0,"td"),e._UZ(1,"ngb-highlight",50),e.ALo(2,"currency"),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("result",e.xi3(2,1,t.precio_luna_v,"S/ "))}}function ze(i,n){if(1&i&&(e.TgZ(0,"td"),e._UZ(1,"ngb-highlight",50),e.ALo(2,"currency"),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("result",e.xi3(2,1,t.precio_accesorio_v,"S/ "))}}function Ie(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"ngb-highlight",50),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"ngb-highlight",50),e.qZA(),e.YNc(5,Me,4,2,"td",51),e.YNc(6,Je,2,1,"td",51),e.YNc(7,Ee,2,1,"td",51),e.TgZ(8,"td"),e._UZ(9,"ngb-highlight",50),e.qZA(),e.YNc(10,Ve,3,4,"td",51),e.YNc(11,we,3,4,"td",51),e.YNc(12,ze,3,4,"td",51),e.TgZ(13,"td"),e._UZ(14,"ngb-highlight",50),e.ALo(15,"currency"),e.qZA(),e.TgZ(16,"td"),e.TgZ(17,"a",52),e.TgZ(18,"i",53),e.NdJ("click",function(a){const l=e.CHM(t).index;return e.oxw().substractQuantityProduct(a,l)}),e.qZA(),e.qZA(),e.TgZ(19,"a",54),e.TgZ(20,"i",55),e.NdJ("ngModelChange",function(a){return e.CHM(t).$implicit.num=a})("click",function(a){const l=e.CHM(t).index;return e.oxw().addQuantityProduct(a,l)}),e.qZA(),e.qZA(),e.TgZ(21,"a",56),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(),h=e.MAs(90);return l.centerModalEditarPrecio(h,r)}),e._UZ(22,"i",57),e.qZA(),e.TgZ(23,"a",58),e.TgZ(24,"i",59),e.NdJ("click",function(a){const l=e.CHM(t).index;return e.oxw().removeCartProduct(a,l)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=n.$implicit,o=n.index;e.xp6(2),e.Q6J("result",o+1),e.xp6(2),e.Q6J("result",t.tipo),e.xp6(1),e.Q6J("ngIf","montura"==t.tipo),e.xp6(1),e.Q6J("ngIf","luna"==t.tipo),e.xp6(1),e.Q6J("ngIf","accesorio"==t.tipo),e.xp6(2),e.Q6J("result",t.cant_vendida),e.xp6(1),e.Q6J("ngIf","montura"==t.tipo),e.xp6(1),e.Q6J("ngIf","luna"==t.tipo),e.xp6(1),e.Q6J("ngIf","accesorio"==t.tipo),e.xp6(2),e.Q6J("result",e.xi3(15,11,t.precio,"S/ ")),e.xp6(6),e.Q6J("ngModel",t.num)}}function De(i,n){1&i&&(e.TgZ(0,"div"),e._uU(1," Campo requerido "),e.qZA())}function Le(i,n){1&i&&(e.TgZ(0,"div"),e._uU(1," Ingrese solo n\xfameros "),e.qZA())}const q=function(i){return{"is-invalid":i}};function Re(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",60),e.TgZ(1,"h5",61),e._uU(2,"Cambio de Precio"),e.qZA(),e.TgZ(3,"button",62),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e.qZA(),e.qZA(),e.TgZ(4,"form",47),e.TgZ(5,"div",63),e.TgZ(6,"div",7),e.TgZ(7,"div",64),e.TgZ(8,"label",65),e._uU(9,"Precio Original"),e.qZA(),e._UZ(10,"input",66),e.qZA(),e.TgZ(11,"div",64),e.TgZ(12,"div",67),e.TgZ(13,"label",68),e._uU(14,"Nuevo Precio de Venta"),e.qZA(),e._UZ(15,"input",69),e.TgZ(16,"div",70),e.YNc(17,De,2,0,"div",51),e.YNc(18,Le,2,0,"div",51),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",71),e.TgZ(20,"button",72),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e._uU(21," Cerrar "),e.qZA(),e.TgZ(22,"button",73),e.NdJ("click",function(){return e.CHM(t),e.oxw().actualizarPrecio()}),e._uU(23," Guardar "),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.formEditarPrecio),e.xp6(6),e.s9C("formControlName",t.precioOriginal_Editar),e.xp6(5),e.s9C("formControlName",t.nuevoPrecio_Editar),e.Q6J("ngClass",e.VKq(6,q,t.formEP.campoNuevoPrecioEditar.invalid&&(t.formEP.campoNuevoPrecioEditar.dirty||t.formEP.campoNuevoPrecioEditar.touched))),e.xp6(2),e.Q6J("ngIf",null==t.formEP.campoNuevoPrecioEditar.errors?null:t.formEP.campoNuevoPrecioEditar.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.formEP.campoNuevoPrecioEditar.errors?null:t.formEP.campoNuevoPrecioEditar.errors.pattern)}}function ke(i,n){1&i&&(e.TgZ(0,"div",108),e._uU(1," Campo requerido "),e.qZA())}function Oe(i,n){1&i&&(e.TgZ(0,"div",108),e._uU(1," Ingrese como m\xe1ximo 2 decimales "),e.qZA())}function Fe(i,n){if(1&i&&(e.TgZ(0,"div",108),e.YNc(1,ke,2,0,"div",93),e.YNc(2,Oe,2,0,"div",93),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.formContado.controls.campoCantidadRecibidaContado.errors.required),e.xp6(1),e.Q6J("ngIf",t.formContado.controls.campoCantidadRecibidaContado.errors.pattern)}}function Qe(i,n){1&i&&(e.TgZ(0,"div",108),e._uU(1," Campo requerido "),e.qZA())}function He(i,n){if(1&i&&(e.TgZ(0,"div",108),e.YNc(1,Qe,2,0,"div",93),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.formContado.controls.campoMetodoPagoContado.errors.required)}}function Be(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"This value is required."),e.qZA())}function Ye(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,Be,2,0,"span",51),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.form.title.errors.required)}}function $e(i,n){1&i&&e._UZ(0,"a",45),2&i&&e.Q6J("innerHTML",n.$implicit.nombres_apellidos,e.oJD)}function je(i,n){1&i&&e._UZ(0,"div",45),2&i&&e.Q6J("innerHTML",n.$implicit,e.oJD)}function Ge(i,n){1&i&&(e.TgZ(0,"div"),e._uU(1," Campo requerido "),e.qZA())}function Ke(i,n){1&i&&(e.TgZ(0,"div"),e._uU(1," Ingrese solo letras "),e.qZA())}function Xe(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"form",87),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw(2).saveEvent()}),e.TgZ(1,"div",88),e.TgZ(2,"div",89),e.TgZ(3,"div",90),e.TgZ(4,"label",91),e._uU(5,"Cantidad Recibida"),e.qZA(),e.TgZ(6,"input",92),e.NdJ("change",function(a){return e.CHM(t),e.oxw(2).updatePago(a)}),e.qZA(),e.YNc(7,Fe,3,2,"div",93),e.qZA(),e.qZA(),e.TgZ(8,"div",89),e.TgZ(9,"div",90),e.TgZ(10,"label",94),e._uU(11,"M\xe9todo"),e.qZA(),e._UZ(12,"ng-select",95),e.YNc(13,He,2,1,"div",93),e.qZA(),e.qZA(),e.TgZ(14,"div",89),e.TgZ(15,"div",90),e.TgZ(16,"label",91),e._uU(17,"Fecha"),e.qZA(),e._UZ(18,"input",96),e.YNc(19,Ye,2,1,"div",97),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",7),e.TgZ(21,"div",18),e.TgZ(22,"div",90),e.TgZ(23,"label",91),e._uU(24,"Buscar Cliente"),e.qZA(),e.TgZ(25,"ng-autocomplete",98),e.NdJ("selected",function(a){return e.CHM(t),e.oxw(2).selectEventCliente(a)}),e.qZA(),e.YNc(26,$e,1,1,"ng-template",null,99,e.W1O),e.YNc(28,je,1,1,"ng-template",null,27,e.W1O),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",7),e.TgZ(31,"div",18),e.TgZ(32,"label",100),e._uU(33,"Montos:"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(34,"div",7),e.TgZ(35,"div",89),e.TgZ(36,"div",90),e.TgZ(37,"label",91),e._uU(38,"Total"),e.qZA(),e._UZ(39,"input",101),e.qZA(),e.qZA(),e.TgZ(40,"div",89),e.TgZ(41,"div",90),e.TgZ(42,"label",91),e._uU(43,"Pago"),e.qZA(),e._UZ(44,"input",102),e.qZA(),e.qZA(),e.TgZ(45,"div",89),e.TgZ(46,"div",90),e.TgZ(47,"label",91),e._uU(48,"Cambio"),e.qZA(),e._UZ(49,"input",103),e.qZA(),e.qZA(),e.qZA(),e.TgZ(50,"div",7),e.TgZ(51,"div",31),e.TgZ(52,"div",90),e.TgZ(53,"label",104),e._uU(54,"Observaciones"),e.qZA(),e._UZ(55,"textarea",105),e.qZA(),e.qZA(),e.qZA(),e.TgZ(56,"div",7),e.TgZ(57,"div",31),e.TgZ(58,"div",67),e.TgZ(59,"label",106),e._uU(60,"Responsable de la Venta"),e.qZA(),e._UZ(61,"input",107),e.TgZ(62,"div",70),e.YNc(63,Ge,2,0,"div",51),e.YNc(64,Ke,2,0,"div",51),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(65,"div",36),e.TgZ(66,"button",72),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeEventModal()}),e._uU(67," Cerrar "),e.qZA(),e.TgZ(68,"button",37),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).guardarVenta()}),e._uU(69," Registrar Venta "),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.MAs(27),o=e.MAs(29),a=e.oxw(2);e.Q6J("formGroup",a.formContado),e.xp6(6),e.s9C("formControlName",a.cantidadRecibida_Contado),e.xp6(1),e.Q6J("ngIf",a.formContado.controls.campoCantidadRecibidaContado.invalid&&(a.formContado.controls.campoCantidadRecibidaContado.dirty||a.formContado.controls.campoCantidadRecibidaContado.touched)),e.xp6(5),e.s9C("formControlName",a.metodoPagoContado),e.Q6J("items",a.listMetodosPagos),e.xp6(1),e.Q6J("ngIf",a.formContado.controls.campoMetodoPagoContado.invalid&&(a.formContado.controls.campoMetodoPagoContado.dirty||a.formContado.controls.campoMetodoPagoContado.touched)),e.xp6(5),e.s9C("formControlName",a.fechaVenta_Contado),e.Q6J("ngClass",e.VKq(26,q,a.submitted&&a.form.title.errors)),e.xp6(1),e.Q6J("ngIf",a.submitted&&a.form.title.errors),e.xp6(6),e.s9C("formControlName",a.nombreContado),e.Q6J("data",a.listClients)("searchKeyword",a.keywordCliente)("itemTemplate",t)("notFoundTemplate",o),e.xp6(14),e.s9C("formControlName",a.precioTotal_Contado),e.Q6J("ngClass",e.VKq(28,q,a.submitted&&a.form.title.errors)),e.xp6(5),e.s9C("formControlName",a.pago_Contado),e.Q6J("ngClass",e.VKq(30,q,a.submitted&&a.form.title.errors)),e.xp6(5),e.s9C("formControlName",a.cambio_Contado),e.Q6J("ngClass",e.VKq(32,q,a.submitted&&a.form.title.errors)),e.xp6(6),e.s9C("formControlName",a.observaciones_Contado),e.xp6(6),e.s9C("formControlName",a.vendedor_Contado),e.Q6J("ngClass",e.VKq(34,q,a.formVContado.campoVendedorContado.invalid&&(a.formVContado.campoVendedorContado.dirty||a.formVContado.campoVendedorContado.touched))),e.xp6(2),e.Q6J("ngIf",null==a.formVContado.campoVendedorContado.errors?null:a.formVContado.campoVendedorContado.errors.required),e.xp6(1),e.Q6J("ngIf",null==a.formVContado.campoVendedorContado.errors?null:a.formVContado.campoVendedorContado.errors.pattern),e.xp6(4),e.Q6J("disabled",!a.formContado.valid)}}function We(i,n){1&i&&(e.TgZ(0,"div",108),e._uU(1," Campo requerido "),e.qZA())}function et(i,n){1&i&&(e.TgZ(0,"div",108),e._uU(1," Ingrese como m\xe1ximo 2 decimales "),e.qZA())}function tt(i,n){if(1&i&&(e.TgZ(0,"div",108),e.YNc(1,We,2,0,"div",93),e.YNc(2,et,2,0,"div",93),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.formCredito.controls.campoCantidadRecibidaCredito.errors.required),e.xp6(1),e.Q6J("ngIf",t.formCredito.controls.campoCantidadRecibidaCredito.errors.pattern)}}function ot(i,n){1&i&&(e.TgZ(0,"div",108),e._uU(1," Campo requerido "),e.qZA())}function it(i,n){if(1&i&&(e.TgZ(0,"div",108),e.YNc(1,ot,2,0,"div",93),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.formCredito.controls.campoMetodoPagoCredito.errors.required)}}function at(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"This value is required."),e.qZA())}function nt(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,at,2,0,"span",51),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.form.title.errors.required)}}function rt(i,n){1&i&&e._UZ(0,"a",45),2&i&&e.Q6J("innerHTML",n.$implicit.nombres_apellidos,e.oJD)}function st(i,n){1&i&&e._UZ(0,"div",45),2&i&&e.Q6J("innerHTML",n.$implicit,e.oJD)}function lt(i,n){1&i&&(e.TgZ(0,"div"),e._uU(1," Campo requerido "),e.qZA())}function dt(i,n){1&i&&(e.TgZ(0,"div"),e._uU(1," Ingrese solo letras "),e.qZA())}function ct(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"form",87),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw(2).saveEvent()}),e.TgZ(1,"div",88),e.TgZ(2,"div",89),e.TgZ(3,"div",90),e.TgZ(4,"label",91),e._uU(5,"Cantidad Recibida"),e.qZA(),e.TgZ(6,"input",109),e.NdJ("change",function(a){return e.CHM(t),e.oxw(2).updatePago(a)}),e.qZA(),e.YNc(7,tt,3,2,"div",93),e.qZA(),e.qZA(),e.TgZ(8,"div",89),e.TgZ(9,"div",90),e.TgZ(10,"label",94),e._uU(11,"M\xe9todo"),e.qZA(),e._UZ(12,"ng-select",95),e.YNc(13,it,2,1,"div",93),e.qZA(),e.qZA(),e.TgZ(14,"div",89),e.TgZ(15,"div",90),e.TgZ(16,"label",91),e._uU(17,"Fecha"),e.qZA(),e._UZ(18,"input",110),e.YNc(19,nt,2,1,"div",97),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",7),e.TgZ(21,"div",18),e.TgZ(22,"div",90),e.TgZ(23,"label",91),e._uU(24,"N\xfamero de Cuotas"),e.qZA(),e.TgZ(25,"div",111),e.TgZ(26,"ng5-slider",112),e.NdJ("valueChange",function(a){return e.CHM(t),e.oxw(2).tickValue=a}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(27,"div",7),e.TgZ(28,"div",18),e.TgZ(29,"div",90),e.TgZ(30,"label",91),e._uU(31,"Buscar o Crear nuevo Cliente"),e.qZA(),e.TgZ(32,"ng-autocomplete",113),e.NdJ("selected",function(a){return e.CHM(t),e.oxw(2).selectEventCliente(a)}),e.qZA(),e.YNc(33,rt,1,1,"ng-template",null,114,e.W1O),e.YNc(35,st,1,1,"ng-template",null,27,e.W1O),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",7),e.TgZ(38,"div",18),e.TgZ(39,"label",100),e._uU(40,"Montos:"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(41,"div",7),e.TgZ(42,"div",89),e.TgZ(43,"div",90),e.TgZ(44,"label",91),e._uU(45,"Total"),e.qZA(),e._UZ(46,"input",115),e.qZA(),e.qZA(),e.TgZ(47,"div",89),e.TgZ(48,"div",90),e.TgZ(49,"label",91),e._uU(50,"Pago"),e.qZA(),e._UZ(51,"input",116),e.qZA(),e.qZA(),e.TgZ(52,"div",89),e.TgZ(53,"div",90),e.TgZ(54,"label",91),e._uU(55,"Deuda"),e.qZA(),e._UZ(56,"input",117),e.qZA(),e.qZA(),e.qZA(),e.TgZ(57,"div",7),e.TgZ(58,"div",31),e.TgZ(59,"div",90),e.TgZ(60,"label",104),e._uU(61,"Observaciones"),e.qZA(),e._UZ(62,"textarea",105),e.qZA(),e.qZA(),e.qZA(),e.TgZ(63,"div",7),e.TgZ(64,"div",31),e.TgZ(65,"div",67),e.TgZ(66,"label",106),e._uU(67,"Responsable de la Venta"),e.qZA(),e._UZ(68,"input",118),e.TgZ(69,"div",70),e.YNc(70,lt,2,0,"div",51),e.YNc(71,dt,2,0,"div",51),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(72,"div",36),e.TgZ(73,"button",72),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeEventModal()}),e._uU(74," Cerrar "),e.qZA(),e.TgZ(75,"button",37),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).guardarVenta()}),e._uU(76," Registrar Venta "),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.MAs(34),o=e.MAs(36),a=e.oxw(2);e.Q6J("formGroup",a.formCredito),e.xp6(6),e.s9C("formControlName",a.cantidadRecibida_Credito),e.xp6(1),e.Q6J("ngIf",a.formCredito.controls.campoCantidadRecibidaCredito.invalid&&(a.formCredito.controls.campoCantidadRecibidaCredito.dirty||a.formCredito.controls.campoCantidadRecibidaCredito.touched)),e.xp6(5),e.s9C("formControlName",a.metodoPagoCredito),e.Q6J("items",a.listMetodosPagos),e.xp6(1),e.Q6J("ngIf",a.formCredito.controls.campoMetodoPagoCredito.invalid&&(a.formCredito.controls.campoMetodoPagoCredito.dirty||a.formCredito.controls.campoMetodoPagoCredito.touched)),e.xp6(5),e.s9C("formControlName",a.fechaVenta_Credito),e.Q6J("ngClass",e.VKq(28,q,a.submitted&&a.form.title.errors)),e.xp6(1),e.Q6J("ngIf",a.submitted&&a.form.title.errors),e.xp6(7),e.Q6J("value",a.tickValue)("options",a.tickValueoptions),e.xp6(6),e.s9C("formControlName",a.nombreCredito),e.Q6J("data",a.listClients)("searchKeyword",a.keywordCliente)("itemTemplate",t)("notFoundTemplate",o),e.xp6(14),e.s9C("formControlName",a.precioTotal_Credito),e.Q6J("ngClass",e.VKq(30,q,a.submitted&&a.form.title.errors)),e.xp6(5),e.s9C("formControlName",a.pago_Credito),e.Q6J("ngClass",e.VKq(32,q,a.submitted&&a.form.title.errors)),e.xp6(5),e.s9C("formControlName",a.cambio_Credito),e.Q6J("ngClass",e.VKq(34,q,a.submitted&&a.form.title.errors)),e.xp6(6),e.s9C("formControlName",a.observaciones_Credito),e.xp6(6),e.s9C("formControlName",a.vendedor_Credito),e.Q6J("ngClass",e.VKq(36,q,a.formVCredito.campoVendedorCredito.invalid&&(a.formVCredito.campoVendedorCredito.dirty||a.formVCredito.campoVendedorCredito.touched))),e.xp6(2),e.Q6J("ngIf",null==a.formVCredito.campoVendedorCredito.errors?null:a.formVCredito.campoVendedorCredito.errors.required),e.xp6(1),e.Q6J("ngIf",null==a.formVCredito.campoVendedorCredito.errors?null:a.formVCredito.campoVendedorCredito.errors.pattern),e.xp6(4),e.Q6J("disabled",!a.formCredito.valid)}}function ut(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",60),e.TgZ(1,"h5",74),e._uU(2,"Registrar Venta"),e.qZA(),e.TgZ(3,"button",62),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e.qZA(),e.qZA(),e.TgZ(4,"div",75),e.TgZ(5,"div",76),e.TgZ(6,"ul",77,78),e.NdJ("navChange",function(a){return e.CHM(t),e.oxw().selectorMetodoPago(a)}),e.TgZ(8,"li",79),e.TgZ(9,"a",80),e.TgZ(10,"span",81),e._UZ(11,"i",82),e.qZA(),e.TgZ(12,"span",83),e._uU(13,"Al Contado"),e.qZA(),e.qZA(),e.YNc(14,Xe,70,36,"ng-template",84),e.qZA(),e.TgZ(15,"li",79),e.TgZ(16,"a",80),e.TgZ(17,"span",81),e._UZ(18,"i",85),e.qZA(),e.TgZ(19,"span",83),e._uU(20,"Al Cr\xe9dito"),e.qZA(),e.qZA(),e.YNc(21,ct,77,38,"ng-template",84),e.qZA(),e.qZA(),e._UZ(22,"div",86),e.qZA(),e.qZA()}if(2&i){const t=e.MAs(7),o=e.oxw();e.xp6(6),e.Q6J("activeId",o.activePago),e.xp6(2),e.Q6J("ngbNavItem",1),e.xp6(7),e.Q6J("ngbNavItem",2),e.xp6(7),e.Q6J("ngbNavOutlet",t)}}function mt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",60),e.TgZ(1,"h5",61),e._uU(2,"Factura de Venta"),e.qZA(),e.TgZ(3,"button",119),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("Cross click")}),e.qZA(),e.qZA(),e.TgZ(4,"div",63),e.TgZ(5,"div",7),e.TgZ(6,"div",31),e.TgZ(7,"div",120),e.TgZ(8,"div",5),e.TgZ(9,"div",121),e.TgZ(10,"h4",122),e._uU(11,"Factura #MN0131 "),e.TgZ(12,"span",123),e._uU(13,"Paid"),e.qZA(),e.qZA(),e.TgZ(14,"div",67),e._UZ(15,"img",124),e.qZA(),e.TgZ(16,"div",125),e.TgZ(17,"p",126),e._UZ(18,"i",127),e._uU(19,"641 Counts Lane Wilmore, KY 40390"),e.qZA(),e.TgZ(20,"p",126),e._UZ(21,"i",128),e._uU(22," abc@123.com"),e.qZA(),e.TgZ(23,"p"),e._UZ(24,"i",129),e._uU(25," 012-345-6789"),e.qZA(),e.qZA(),e.qZA(),e._UZ(26,"hr",130),e.TgZ(27,"div",7),e.TgZ(28,"div",64),e.TgZ(29,"div",125),e.TgZ(30,"h5",131),e._uU(31,"Facturado a:"),e.qZA(),e.TgZ(32,"h5",132),e._uU(33,"Preston Miller"),e.qZA(),e.TgZ(34,"p",126),e._uU(35,"4450 Fancher Drive Dallas, TX 75247"),e.qZA(),e.TgZ(36,"p",126),e._uU(37,"PrestonMiller@armyspy.com"),e.qZA(),e.TgZ(38,"p"),e._uU(39,"001-234-5678"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(40,"div",64),e.TgZ(41,"div",133),e.TgZ(42,"div"),e.TgZ(43,"h5",134),e._uU(44,"N\xba de Factura:"),e.qZA(),e.TgZ(45,"p"),e._uU(46,"#MN0131"),e.qZA(),e.qZA(),e.TgZ(47,"div",135),e.TgZ(48,"h5",134),e._uU(49,"Fecha de la Factura:"),e.qZA(),e.TgZ(50,"p"),e._uU(51,"09 Jul, 2020"),e.qZA(),e.qZA(),e.TgZ(52,"div",135),e.TgZ(53,"h5",134),e._uU(54,"N\xba de pedido:"),e.qZA(),e.TgZ(55,"p"),e._uU(56,"#1123456"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(57,"div",136),e.TgZ(58,"h5",137),e._uU(59,"Resumen del Pedido"),e.qZA(),e.TgZ(60,"div",13),e.TgZ(61,"table",138),e.TgZ(62,"thead"),e.TgZ(63,"tr"),e.TgZ(64,"th",139),e._uU(65,"No."),e.qZA(),e.TgZ(66,"th"),e._uU(67,"Detalle"),e.qZA(),e.TgZ(68,"th"),e._uU(69,"Precio"),e.qZA(),e.TgZ(70,"th"),e._uU(71,"Cantidad"),e.qZA(),e.TgZ(72,"th",140),e._uU(73,"Total"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(74,"tbody"),e.TgZ(75,"tr"),e.TgZ(76,"th",141),e._uU(77,"01"),e.qZA(),e.TgZ(78,"td"),e.TgZ(79,"h5",142),e._uU(80,"Nike N012 Running Shoes"),e.qZA(),e.TgZ(81,"ul",143),e.TgZ(82,"li",144),e._uU(83,"Color : "),e.TgZ(84,"span",145),e._uU(85,"Gray"),e.qZA(),e.qZA(),e.TgZ(86,"li",144),e._uU(87,"Size : "),e.TgZ(88,"span",145),e._uU(89,"08"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(90,"td"),e._uU(91,"$260"),e.qZA(),e.TgZ(92,"td"),e._uU(93,"1"),e.qZA(),e.TgZ(94,"td",146),e._uU(95,"PEN 260.00"),e.qZA(),e.qZA(),e.TgZ(96,"tr"),e.TgZ(97,"th",141),e._uU(98,"02"),e.qZA(),e.TgZ(99,"td"),e.TgZ(100,"h5",142),e._uU(101,"Adidas Running Shoes"),e.qZA(),e.TgZ(102,"ul",143),e.TgZ(103,"li",144),e._uU(104,"Color : "),e.TgZ(105,"span",145),e._uU(106,"Black"),e.qZA(),e.qZA(),e.TgZ(107,"li",144),e._uU(108,"Size : "),e.TgZ(109,"span",145),e._uU(110,"09"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(111,"td"),e._uU(112,"$250"),e.qZA(),e.TgZ(113,"td"),e._uU(114,"1"),e.qZA(),e.TgZ(115,"td",146),e._uU(116,"PEN 250.00"),e.qZA(),e.qZA(),e.TgZ(117,"tr"),e.TgZ(118,"th",147),e._uU(119,"Sub Total"),e.qZA(),e.TgZ(120,"td",146),e._uU(121,"PEN 510.00"),e.qZA(),e.qZA(),e.TgZ(122,"tr"),e.TgZ(123,"th",148),e._uU(124," Descuento :"),e.qZA(),e.TgZ(125,"td",149),e._uU(126,"- PEN 50.00"),e.qZA(),e.qZA(),e.TgZ(127,"tr"),e.TgZ(128,"th",148),e._uU(129," Costo de env\xedo :"),e.qZA(),e.TgZ(130,"td",149),e._uU(131,"PEN 25.00"),e.qZA(),e.qZA(),e.TgZ(132,"tr"),e.TgZ(133,"th",148),e._uU(134," Impuesto (IGV)"),e.qZA(),e.TgZ(135,"td",149),e._uU(136,"PEN 13.00"),e.qZA(),e.qZA(),e.TgZ(137,"tr"),e.TgZ(138,"th",148),e._uU(139,"Total"),e.qZA(),e.TgZ(140,"td",149),e.TgZ(141,"h4",150),e._uU(142,"PEN 498.00"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(143,"div",71),e.TgZ(144,"a",151),e._UZ(145,"i",152),e.qZA(),e.TgZ(146,"a",153),e._UZ(147,"i",154),e.qZA(),e.TgZ(148,"button",155),e.NdJ("click",function(){return e.CHM(t).$implicit.close("Close click")}),e._uU(149,"Cerrar"),e.qZA(),e.TgZ(150,"button",156),e._uU(151,"Guardar cambios"),e.qZA(),e.qZA()}}L().vfs=ae.I.vfs;let _t=(()=>{class i{constructor(t,o,a,r,l){this.fb=t,this.modalService=o,this.productosService=a,this.customerService=r,this.usuarioService=l,this.role="Admin",this.nombre_sedes="campoSede",this.idSede="",this.currentPage=1,this.pageSize=10,this.submitted_Contado=!1,this.cantidadRecibida_Contado="campoCantidadRecibidaContado",this.fechaVenta_Contado="campoFechaVentaContado",this.usuario_Contado="campoUsuarioContado",this.nombreContado="campoNombreContado",this.precioTotal_Contado="campoPrecioTotalContado",this.pago_Contado="campoPagoContado",this.cambio_Contado="campoCambioContado",this.observaciones_Contado="campoObservacionesContado",this.vendedor_Contado="campoVendedorContado",this.metodoPagoContado="campoMetodoPagoContado",this.cantidadRecibida_Credito="campoCantidadRecibidaCredito",this.fechaVenta_Credito="campoFechaVentaCredito",this.usuario_Credito="campoUsuarioCredito",this.nombreCredito="campoNombreCredito",this.precioTotal_Credito="campoPrecioTotalCredito",this.pago_Credito="campoPagoCredito",this.cambio_Credito="campoCambioCredito",this.observaciones_Credito="campoObservacionesCredito",this.vendedor_Credito="campoVendedorCredito",this.metodoPagoCredito="campoMetodoPagoCredito",this.submitted_EditarPrecio=!1,this.precioOriginal_Editar="campoPrecioOriginalEditar",this.nuevoPrecio_Editar="campoNuevoPrecioEditar",this.listAllProducts=[],this.active=1,this.keyword="id_producto",this.keywordCliente="nombres_apellidos",this.products=[],this.venta=new ie,this.tipoPago=new Ae,this.activePago=1,this.selectorPago="contado",this.listMetodosPagos=["F\xedsico","Yape","Plin","Interbancario"],this.listClients=[],this.btnGuardar=!1,this.lettersPattern="[a-zA-Z\xf1\xd1\xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda ]*",this.numberPattern="(^[0-9])+([.][0-9]{1,2})?$",this.decimalPattern=/^\d+(\.\d{1,2})?$/,this.tickValue=2,this.tickValueoptions={showTicksValues:!0,stepsArray:[{value:2,legend:"M\xednimo"},{value:3},{value:4},{value:5,legend:"M\xe1ximo"}]}}ngOnInit(){this.breadCrumbItems=[{label:"Venta"},{label:"Realizar Venta",active:!0}],this.getListSedes(),this.getListMonturas(this.usuarioService.getSedebyUser()),this.crearFormularioEditarPrecio()}getListSedes(){this.listSedes=JSON.parse(localStorage.getItem("sedes")),this.idSede=this.usuarioService.getSedebyUser()}crearFormularioEditarPrecio(){this.formEditarPrecio=this.fb.group({[this.precioOriginal_Editar]:[{value:"S/ 000.00",disabled:!0}],[this.nuevoPrecio_Editar]:[null,[s.kI.required,s.kI.pattern(this.decimalPattern)]]}),this.formSedes=this.fb.group({[this.nombre_sedes]:[this.idSede]})}fS(t){return this.formSedes.get(t)}changeSede(){this.idSede=this.fS(this.nombre_sedes).value,this.updateProductosbySede(this.idSede)}updateProductosbySede(t){this.listAllProducts=[],this.products=[],this.listMonturasforSale=[],this.getListMonturas(t)}fE(t){return this.formEditarPrecio.get(t)}crearFormulario(){this.formContado=this.fb.group({[this.cantidadRecibida_Contado]:[null,[s.kI.required,s.kI.pattern(this.decimalPattern)]],[this.fechaVenta_Contado]:[{value:null,disabled:!0}],[this.usuario_Contado]:[null],[this.precioTotal_Contado]:[{value:null,disabled:!0}],[this.pago_Contado]:[{value:null,disabled:!0}],[this.cambio_Contado]:[{value:null,disabled:!0}],[this.observaciones_Contado]:[null],[this.vendedor_Contado]:[null,[s.kI.required,s.kI.pattern(this.lettersPattern)]],[this.metodoPagoContado]:[null,[s.kI.required]],[this.nombreContado]:[null,[s.kI.required]]}),this.formCredito=this.fb.group({[this.cantidadRecibida_Credito]:[null,[s.kI.required,s.kI.pattern(this.decimalPattern)]],[this.fechaVenta_Credito]:[{value:null,disabled:!0}],[this.usuario_Credito]:[null],[this.precioTotal_Credito]:[{value:null,disabled:!0}],[this.pago_Credito]:[{value:null,disabled:!0}],[this.cambio_Credito]:[{value:null,disabled:!0}],[this.observaciones_Credito]:[null],[this.vendedor_Credito]:[null,[s.kI.required,s.kI.pattern(this.lettersPattern)]],[this.metodoPagoCredito]:[null,[s.kI.required]],[this.nombreCredito]:[null,[s.kI.required]]})}get formVContado(){return this.formContado.controls}get formVCredito(){return this.formCredito.controls}onSort({column:t}){this.headers.forEach(a=>{a.sortable!==t&&(a.direction="")})}centerModal(t,o){this.crearFormulario(),this.getListClients(),this.fechaVenta=new Date(Date.now()),this.modalService.open(t,{centered:!0,windowClass:"modal-holder"}),this.f(this.fechaVenta_Contado).setValue(this.fechaVenta.toLocaleDateString()),this.f(this.precioTotal_Contado).setValue(this.precioTotalVenta.toFixed(2)),this.g(this.fechaVenta_Credito).setValue(this.fechaVenta.toLocaleDateString()),this.g(this.precioTotal_Credito).setValue(this.precioTotalVenta.toFixed(2))}scrollModal(t){this.modalService.open(t,{size:"xl",scrollable:!0})}centerModalEditarPrecio(t,o){switch(this.formEditarPrecio.reset(),this.tmpProducto=o,o.tipo){case"montura":this.fE(this.precioOriginal_Editar).setValue(o.precio_montura_v);break;case"accesorio":this.fE(this.precioOriginal_Editar).setValue(o.precio_accesorio_v);break;case"luna":this.fE(this.precioOriginal_Editar).setValue(o.precio_luna_v)}this.modalService.open(t,{scrollable:!0,size:"md",windowClass:"modal-holder",centered:!0})}actualizarPrecio(){let t=Number(this.fE(this.nuevoPrecio_Editar).value);switch(this.tmpProducto.tipo){case"montura":this.products.forEach(o=>{o.id_producto==this.tmpProducto.id_producto&&(o.precio_montura_v=isNaN(t)?0:t,o.precio=o.precio_montura_v*o.cant_vendida)});break;case"accesorio":this.products.forEach(o=>{o.id_producto==this.tmpProducto.id_producto&&(o.precio_accesorio_v=isNaN(t)?0:t,o.precio=o.precio_accesorio_v*o.cant_vendida)});break;case"luna":this.products.forEach(o=>{o.id_producto==this.tmpProducto.id_producto&&(o.precio_luna_v=isNaN(t)?0:t,o.precio=o.precio_luna_v*o.cant_vendida)})}this.modalService.dismissAll()}deleteEventData(){this.editEvent.remove(),this.modalService.dismissAll()}closeEventModal(){this.modalService.dismissAll()}saveEvent(){this.submitted_Contado=!0}getListMonturas(t){(0,_.H)("loading","Cargando..."),this.productosService.getMonturasforSale(t).subscribe(o=>{this.listAllProducts=o,this.listMonturasforSale=o,this.getListAccesorios(t)})}getListAccesorios(t){this.productosService.getAccesoriosforSale(t).subscribe(o=>{this.listAllProducts=[...o,...this.listAllProducts],this.getListLunas(t)})}getListLunas(t){this.productosService.getLunasforSale(t).subscribe(o=>{this.listAllProducts=[...o,...this.listAllProducts],(0,_.H)("close",null)})}getListClients(){this.customerService.getAllClientsforSale().subscribe(t=>{this.listClients=t,this.listClients.forEach(o=>{o.nombres_apellidos=o.apellidos+" "+o.nombres})})}selectorMetodoPago(t){this.selectorPago=1==t.nextId?"contado":"credito"}selectEvent(t){const o=this.products.find(a=>a.id_producto===t.id_producto);if(o){if(o.cant_vendida+1>o.cantidad)return(0,_.H)("error","No se puede agregar m\xe1s productos del stock"),this.autocomplete.clear(),void this.autocomplete.close();o.cant_vendida+=1,this.autocomplete.clear(),this.autocomplete.close()}else{switch(t.tipo){case"montura":this.products.push(Object.assign(Object.assign({},t),{cant_vendida:1,precio:t.precio_montura_v})),this.autocomplete.clear(),this.autocomplete.close();break;case"luna":this.products.push(Object.assign(Object.assign({},t),{cant_vendida:1,precio:t.precio_luna_v})),this.autocomplete.clear(),this.autocomplete.close();break;case"accesorio":this.products.push(Object.assign(Object.assign({},t),{cant_vendida:1,precio:t.precio_accesorio_v})),this.autocomplete.clear(),this.autocomplete.close()}this.estadoBotonGuardar()}}selectEventCliente(t){this.customer=t,"contado"==this.selectorPago?this.f(this.usuario_Contado).setValue(t.id_cliente):this.g(this.usuario_Credito).setValue(t.id_cliente),this.venta.nombre_cliente=t.nombres+" "+t.apellidos}onChangeSearch(t){}onFocused(t){this.autocomplete.close()}getTotalCost(){return this.precioTotalVenta=this.products.map(t=>t.precio).reduce((t,o)=>t+o,0),this.precioTotalVenta=(0,y.NM)(this.precioTotalVenta,1),this.precioTotalVenta}addQuantityProduct(t,o){if(this.products[o].cant_vendida+1>this.products[o].cantidad)(0,_.H)("error","No se puede agregar m\xe1s productos del stock");else switch(this.products[o].cant_vendida+=1,this.products[o].tipo){case"montura":this.products[o].precio=this.products[o].precio_montura_v*this.products[o].cant_vendida;break;case"luna":this.products[o].precio=this.products[o].precio_luna_v*this.products[o].cant_vendida;break;case"accesorio":this.products[o].precio=this.products[o].precio_accesorio_v*this.products[o].cant_vendida}}substractQuantityProduct(t,o){switch(this.products[o].cant_vendida-=1,this.products[o].tipo){case"montura":this.products[o].precio=this.products[o].precio_montura_v*this.products[o].cant_vendida;break;case"luna":this.products[o].precio=this.products[o].precio_luna_v*this.products[o].cant_vendida;break;case"accesorio":this.products[o].precio=this.products[o].precio_accesorio_v*this.products[o].cant_vendida}0===this.products[o].cant_vendida&&this.removeProduct()}removeProduct(){this.products=this.products.filter(t=>0!==t.cant_vendida)}removeCartProduct(t,o){this.products[o].cant_vendida=0,this.removeProduct(),this.estadoBotonGuardar()}estadoBotonGuardar(){this.btnGuardar=0!=this.products.length}get formEP(){return this.formEditarPrecio.controls}f(t){return this.formContado.get(t)}g(t){return this.formCredito.get(t)}updatePago(t){if("contado"==this.selectorPago)this.f(this.pago_Contado).setValue(this.f(this.cantidadRecibida_Contado).value),this.f(this.cambio_Contado).setValue((this.f(this.cantidadRecibida_Contado).value-this.precioTotalVenta).toFixed(2));else{const o=Number((this.g(this.cantidadRecibida_Credito).value-this.precioTotalVenta).toFixed(2));this.g(this.pago_Credito).setValue(this.g(this.cantidadRecibida_Credito).value),this.g(this.cambio_Credito).setValue(Math.abs(o))}}guardarVenta(){if(this.formContado.valid||this.formCredito.valid){const t=this.products.filter(r=>"montura"==r.tipo),o=this.products.filter(r=>"luna"==r.tipo),a=this.products.filter(r=>"accesorio"==r.tipo);if(this.venta.list_monturas=t,this.venta.list_lunas=o,this.venta.list_accesorios=a,this.venta.fecha_creacion_venta=new Date(Date.now()),"contado"==this.selectorPago){if(this.venta.nombre_jalador=this.f(this.vendedor_Contado).value,this.tipoPago.observaciones=this.f(this.observaciones_Contado).value,this.tipoPago.cantidad_recibida=Number(this.f(this.cantidadRecibida_Contado).value),this.f(this.cantidadRecibida_Contado).value-this.precioTotalVenta<0)return void(0,_.H)("error","El pago no puede ser menor al valor de la compra, se sugiere compra al cr\xe9dito");if(this.tipoPago.deuda=0,this.tipoPago.metodo_pago=this.f(this.metodoPagoContado).value,this.tipoPago.cuotas=String(0),null==this.listClients.find(l=>l.id_cliente==this.f(this.nombreContado).value.id_cliente))return void this.f(this.nombreContado).setValue(null);this.venta.id_cliente=this.f(this.nombreContado).value.id_cliente,this.venta.encargado_medicion=this.f(this.nombreContado).value.medidas[0].encargado}else{if(this.precioTotalVenta-this.g(this.cantidadRecibida_Credito).value<0)return void(0,_.H)("error","El pago no puede ser mayor al valor de la compra, se sugiere compra al contado");if(this.venta.nombre_jalador=this.g(this.vendedor_Credito).value,this.tipoPago.observaciones=this.g(this.observaciones_Credito).value,this.tipoPago.cantidad_recibida=Number(this.g(this.cantidadRecibida_Credito).value),this.tipoPago.deuda=(0,y.NM)(this.precioTotalVenta-this.g(this.cantidadRecibida_Credito).value,1),this.tipoPago.metodo_pago=this.g(this.metodoPagoCredito).value,this.tipoPago.cuotas=String(this.tickValue),null==this.listClients.find(l=>l.id_cliente==this.g(this.nombreCredito).value.id_cliente))return void this.g(this.nombreCredito).setValue(null);this.venta.id_cliente=this.g(this.nombreCredito).value.id_cliente,this.venta.encargado_medicion=this.g(this.nombreCredito).value.medidas[0].encargado}this.venta.id_vendedor=this.usuarioService.getUser().id_usuario,this.venta.nombre_vendedor=this.usuarioService.getUser().nombres+" "+this.usuarioService.getUser().apellidos,this.tipoPago.forma_pago=this.selectorPago,this.tipoPago.precio_total=this.precioTotalVenta,this.tipoPago.fecha_pago=new Date,this.venta.tipo_venta.push(this.tipoPago),this.venta.id_sede=this.idSede,this.venta.habilitado=!0,this.cancel()}}cancel(){const t=U().mixin({customClass:{cancelButton:"btn btn-danger ms-2",confirmButton:"btn btn-success"},buttonsStyling:!1});t.fire({title:"\xbfEst\xe1 seguro de realizar la venta?",text:"\xa1No se podr\xe1 revertir esto!",icon:"warning",cancelButtonText:"No, cancelar!",confirmButtonText:"Si, vender!",showCancelButton:!0}).then(o=>{o.value?((0,_.H)("loading","Cargando..."),this.productosService.createVenta(this.venta).subscribe(a=>{this.createPDF(this.venta,this.customer),(0,_.H)("close",null),(0,_.H)("success","Venta realizada"),this.modalService.dismissAll(),this.products=[],this.getListMonturas(this.idSede),this.estadoBotonGuardar()},a=>{(0,_.H)("close",null),404!==a.status&&(0,_.H)("error","Error en la conexi\xf3n")})):o.dismiss===U().DismissReason.cancel&&(this.venta.tipo_venta=[],t.fire("Cancelado","La venta no se ha realizado","error"))})}createPDF(t,o){return(0,oe.mG)(this,void 0,void 0,function*(){var l=new Date(t.fecha_creacion_venta).toLocaleDateString("en-GB"),h=new Date(t.fecha_creacion_venta).toLocaleDateString("es-CL",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),N=new Date(t.fecha_creacion_venta).toLocaleTimeString("es-CL",{timeZone:"America/Bogota",hour12:!0,hour:"numeric",minute:"2-digit",second:"2-digit"}),M=o.nombres+" "+o.apellidos,p=o.fecha_nacimiento?new Date(o.fecha_nacimiento).toLocaleDateString("en-GB"):"Sin fecha de nacimiento",w=o.email?o.email:"Sin correo",g=o.telefono?o.telefono:"Sin telefono",E=[];const ge={pageSize:"A4",pageMargins:[40,60,40,60],content:[{style:"tableMargin",table:{widths:["*","*"],body:[[{image:yield(0,y.up)("/assets/images/logo-dark.png"),width:150},{text:"",style:"tableHeader",rowSpan:3,alignment:"right"}],[{text:"Calle Santa Marta 218, Arequipa",style:"datosempresa"},{}],[{text:"raulcg1234@hotmail.com ",style:"datosempresa"},{}],[{text:"955 739 464",style:"datosempresa"},{}]]},layout:"noBorders"},{style:"tableMargin",table:{widths:["*","*"],body:[[{text:"Facturado a:",style:"tableHeader"},{text:"Fecha de la Boleta:",style:"tableHeader",alignment:"right"}],[{text:M,style:"subtitulo"},{text:l,style:"contenido",alignment:"right"}],[{text:"Fecha de Nacimiento: "+p,style:"contenido"},{text:"",style:"tableHeader",alignment:"right"}],[{text:"Correo: "+w,style:"contenido"},{text:"",style:"contenido",alignment:"right"}],[{text:"Telefono: "+g,style:"contenido"},{}]]},layout:"noBorders"},{text:"Resumen del pedido:",style:"subtitulo"},(x=E,b=["num_orden","detalle","precio","cantidad","total"],A=function(){var b,A,x=1,C=0,T=0;if(t.list_monturas.length>0)for(var c=0;c<t.list_monturas.length;c++)T+=b=t.list_monturas[c].precio_montura_v*t.list_monturas[c].cant_vendida,E.push({num_orden:x+=1,detalle:t.list_monturas[c].marca,precio:t.list_monturas[c].precio_montura_v,cantidad:t.list_monturas[c].cant_vendida,total:b});if(t.list_lunas.length>0)for(c=0;c<t.list_lunas.length;c++)T+=A=t.list_lunas[c].precio_luna_v*t.list_lunas[c].cant_vendida,E.push({num_orden:x+=1,detalle:t.list_lunas[c].material,precio:t.list_lunas[c].precio_luna_v,cantidad:t.list_lunas[c].cant_vendida,total:A});if(t.list_accesorios.length>0)for(c=0;c<t.list_accesorios.length;c++)T+=C=t.list_accesorios[c].precio_accesorio_v*t.list_accesorios[c].cant_vendida,E.push({num_orden:x+=1,detalle:t.list_accesorios[c].nombre_accesorio,precio:t.list_accesorios[c].precio_accesorio_v,cantidad:t.list_accesorios[c].cant_vendida,total:C});return T}(),{style:"tableMargin",color:"#444",table:{widths:[25,"*",63,60,63],heights:[20,20,20,20],headerRows:1,body:function(x,b,A){var C=[];C.push([{text:"No.",style:"tableHeader",alignment:"center"},{text:"Detalle",style:"tableHeader",alignment:"center"},{text:"Precio",style:"tableHeader",alignment:"center"},{text:"Cantidad",style:"tableHeader",alignment:"center"},{text:"Total",style:"tableHeader",alignment:"center"}]),x.forEach(function(c){var u=[];b.forEach(function(B){u.push(c[B].toString())}),C.push(u)});var T=(0,y.NM)(A,1);return C.push([{text:"",border:[!1,!1,!1,!1],colSpan:2},{},{text:"Total:",style:"tableHeader",alignment:"right",colSpan:2},{},{text:"S/ "+T,style:"contenido",alignment:"right"}]),C}(x,b,A)}}),{text:[,{text:"Fecha de Entrega: ",style:"textBold"},h,"   ",{text:"Hora: ",style:"textBold"},N]},{text:"Nota:",style:"subtitulo2"},{text:"Todo trabajo se efectuara con un adelanto del 50%.",style:"contenido2",alignment:"justify"},{text:"La empresa no se responsabiliza de los pedidos no recogidos despu\xe9s de un mes.",style:"contenido2",alignment:"justify"}],styles:{subtitulo:{bold:!0,fontSize:13,color:"black",margin:[0,10,0,5]},subtitulo2:{bold:!0,fontSize:10,color:"black",margin:[0,10,0,5]},contenido:{fontSize:12},contenido2:{fontSize:8},textBold:{fontSize:12,bold:!0},datosempresa:{fontSize:10},header:{fontSize:17,bold:!0,margin:[0,0,0,10]},subheader:{fontSize:13,bold:!0,margin:[0,10,0,5]},subtitle:{fontSize:12,bold:!0,margin:[0,10,0,5]},tableMargin:{margin:[0,15,0,15]},tableOpacityExample:{margin:[0,5,0,15],fillColor:"blue",fillOpacity:.3},tableHeader:{bold:!0,fontSize:13,color:"black"}}};var x,b,A;L().createPdf(ge).open()})}copyText(t){navigator.clipboard?navigator.clipboard.writeText(t.innerText).then(()=>{(0,_.H)("success","Copiado")},o=>{(0,_.H)("error","Error")}):(0,_.H)("error","El navegador no soporta el API Clipboard")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(s.qu),e.Y36(m.FF),e.Y36(qe.k),e.Y36(ne.$),e.Y36(R.i))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-sale"]],viewQuery:function(t,o){if(1&t&&(e.Gf(Se,5),e.Gf(Ce,5)),2&t){let a;e.iGM(a=e.CRH())&&(o.autocomplete=a.first),e.iGM(a=e.CRH())&&(o.headers=a)}},features:[e._Bn([f.JJ])],decls:95,vars:25,consts:[[1,"container-fluid"],["title","A\xf1adir un Producto",3,"breadcrumbItems"],[1,"row","mb-4"],[1,"col-xl-4"],[1,"card","h-100"],[1,"card-body"],[1,"card-title","mb-3"],[1,"row"],[1,"p-2"],[1,"search-box","chat-search-box"],[1,"position-relative"],["type","text","placeholder","Buscar Montura...",1,"form-control","bg-light","border-light","rounded",3,"ngModel","ngModelChange"],[1,"uil","uil-search","search-icon"],[1,"table-responsive"],[1,"table","table-centered","table-nowrap","mb-0","align-middle"],[1,"table-light"],[4,"ngFor","ngForOf"],[1,"row","justify-content-md-between","align-items-md-center"],[1,"col-12"],[1,"text-md-end","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","maxSize","pageChange"],[1,"col-xl-8"],[1,"row","mb-3"],[1,"col-md-8","mb-2","search-box","chat-search-box"],["placeholder","Buscar productos","historyIdentifier","","focusFirst","true","minQueryLength","8",3,"data","searchKeyword","itemTemplate","notFoundTemplate","selected","inputChanged","inputFocused","keyup.enter"],["autocomplete",""],["itemTemplate",""],["notFoundTemplate",""],[1,"col-md-4","mb-2"],["role","toolbar",1,"btn-toolbar"],["class","col-12 d-grid",4,"appRole"],[1,"col-lg-12"],[1,"card-title","mb-4"],[1,"table-responsive","mb-2"],[1,"table","table-centered","dt-responsive","table-nowrap","mb-0","align-middle",2,"border-spacing","0 12px","width","100%"],[1,"bg-transparent"],[1,"text-end","mt-2"],["type","submit","id","btn-save-event",1,"btn","btn-success","ms-1",3,"disabled","click"],[1,"uil","uil-shopping-cart-alt","mt-2","me-1"],["centerDataModalEditar",""],["centerDataModalGuardar2",""],["scrollDataModal",""],["placement","top","ngbTooltip","Copiar c\xf3digo",1,"px-2","text-success",3,"click"],[1,"uil-copy-alt","font-size-18"],["elementToCopy",""],[3,"innerHTML"],[1,"col-12","d-grid"],[3,"formGroup"],["ngbDropdown",""],["placeholder","Seleccione la sede","bindValue","id_sede","bindLabel","nombre_sede",3,"items","formControlName","change"],[3,"result"],[4,"ngIf"],["placement","top","ngbTooltip","Disminuir",1,"px-2","text-warning"],[1,"uil","uil-minus-circle","font-size-18",3,"click"],["placement","top","ngbTooltip","Agregar",1,"px-2","text-success"],["name","quantity","ngDefaultControl","","min","0",1,"uil","uil-plus-circle","font-size-18",3,"ngModel","ngModelChange","click"],["placement","top","ngbTooltip","Editar precio",1,"px-2","text-primary",3,"click"],[1,"uil","uil-pen","font-size-18"],["placement","top","ngbTooltip","Eliminar",1,"px-2","text-danger"],[1,"uil","uil-trash-alt","font-size-18",3,"click"],[1,"modal-header"],[1,"modal-title","mt-0"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-sm-6"],["for","billing-PrecioOriginal",1,"form-label"],["type","text","id","billing-PrecioOriginal","placeholder","Precio Original",1,"form-control",3,"formControlName"],[1,"mb-4"],["for","billing-NuevoPrecio",1,"form-label"],["type","text","id","billing-NuevoPrecio","placeholder","Escriba el nuevo precio",1,"form-control",3,"formControlName","ngClass"],[1,"invalid-feedback"],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"],["type","submit","id","btn-save-event",1,"btn","btn-success","ms-1",3,"click"],["id","modal-title",1,"modal-title"],[1,"modal-body","p-4"],[1,"col-lg-14"],["ngbNav","",1,"nav-pills","nav-justified","bg-light",3,"activeId","navChange"],["justifiednavpills","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],[1,"d-block","d-sm-none"],[1,"fas","fa-home"],[1,"d-none","d-sm-block"],["ngbNavContent",""],[1,"far","fa-user"],[3,"ngbNavOutlet"],[3,"formGroup","ngSubmit"],[1,"row","mt-4"],[1,"col-4"],[1,"mb-3"],[1,"control-label"],["placeholder","Cantidad en soles","type","text","name","nameCantidadRecibidaContado",1,"form-control",3,"formControlName","change"],["class","text-danger",4,"ngIf"],[1,"form-label"],["name","selectMetodo","placeholder","Seleccione",3,"items","formControlName"],["placeholder","Seleccione la fecha","type","text","name","nameFechaRegistroContado",1,"form-control",3,"formControlName","ngClass"],["class","invalid-feedback",4,"ngIf"],["placeholder","Apellidos del cliente","historyIdentifier","",3,"data","searchKeyword","itemTemplate","formControlName","notFoundTemplate","selected"],["itemTemplate3",""],[1,"control-label",2,"text-align","left"],["placeholder","S/ 000.00","type","text","name","nameTotalContado",1,"form-control",3,"formControlName","ngClass"],["placeholder","S/ 000.00","type","text","name","namePagoContado",1,"form-control",3,"formControlName","ngClass"],["placeholder","S/ 000.00","type","text","name","nameCambioContado",1,"form-control",3,"formControlName","ngClass"],["for","billing-observaciones",1,"form-label"],["id","billing-observaciones","rows","3","placeholder","Ingrese las observaciones",1,"form-control",3,"formControlName"],["for","billing-vendedor",1,"form-label"],["placeholder","Nombre Completo","type","text","name","nameVendenorContado",1,"form-control",3,"formControlName","ngClass"],[1,"text-danger"],["placeholder","Cantidad en soles","type","text","name","nameCantidadRecibidaCredito",1,"form-control",3,"formControlName","change"],["placeholder","Seleccione la fecha","type","text","name","nameFechaRegistroCredito",1,"form-control",3,"formControlName","ngClass"],[1,"p-3"],[3,"value","options","valueChange"],["placeholder","Apellidos del cliente","historyIdentifier","",3,"data","searchKeyword","itemTemplate","notFoundTemplate","formControlName","selected"],["itemTemplate2",""],["placeholder","S/ 000.00","type","text","name","nameTotalCredito",1,"form-control",3,"formControlName","ngClass"],["placeholder","S/ 000.00","type","text","name","namePagoCredito",1,"form-control",3,"formControlName","ngClass"],["placeholder","S/ 000.00","type","text","name","nameCambioCredito",1,"form-control",3,"formControlName","ngClass"],["placeholder","Nombre Completo","type","text","name","nameVendenorCredito",1,"form-control",3,"formControlName","ngClass"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"card"],[1,"invoice-title"],[1,"float-end","font-size-16"],[1,"badge","bg-success","font-size-12","ms-2"],["src","assets/images/logo-dark.png","alt","logo","height","20"],[1,"text-muted"],[1,"mb-1"],[1,"uil","uil-map-marker","me-1"],[1,"uil","uil-envelope-alt","me-1"],[1,"uil","uil-phone","me-1"],[1,"my-4"],[1,"font-size-16","mb-3"],[1,"font-size-15","mb-2"],[1,"text-muted","text-sm-end"],[1,"font-size-16","mb-1"],[1,"mt-4"],[1,"py-2"],[1,"font-size-15"],[1,"table","table-nowrap","table-centered","mb-0"],[2,"width","70px"],[1,"text-end",2,"width","120px"],["scope","row"],[1,"font-size-15","mb-1"],[1,"list-inline","mb-0"],[1,"list-inline-item"],[1,"fw-medium"],[1,"text-end"],["scope","row","colspan","4",1,"text-end"],["scope","row","colspan","4",1,"border-0","text-end"],[1,"border-0","text-end"],[1,"m-0"],["href","javascript(0)",1,"btn","btn-success","waves-effect","waves-light","me-1"],[1,"fa","fa-download"],["href","javascript:window.print()",1,"btn","btn-success","waves-effect","waves-light","me-1"],[1,"fa","fa-print"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary"]],template:function(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"div",0),e._UZ(1,"app-page-title",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"h1",6),e._uU(7,"Buscar Producto"),e.qZA(),e.TgZ(8,"div",7),e.TgZ(9,"div",8),e.TgZ(10,"div",9),e.TgZ(11,"div",10),e.TgZ(12,"input",11),e.NdJ("ngModelChange",function(l){return o.searchtext=l}),e.qZA(),e._UZ(13,"i",12),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",7),e.TgZ(15,"div",13),e.TgZ(16,"table",14),e.TgZ(17,"thead",15),e.TgZ(18,"tr"),e.TgZ(19,"th"),e._uU(20,"Copiar"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"Material"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"Marca"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Color"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"C\xf3d. id."),e.qZA(),e.qZA(),e.qZA(),e.TgZ(29,"tbody"),e.YNc(30,Ne,13,4,"tr",16),e.ALo(31,"slice"),e.ALo(32,"filter"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(33,"div",17),e.TgZ(34,"div",18),e.TgZ(35,"div",19),e.TgZ(36,"ngb-pagination",20),e.NdJ("pageChange",function(l){return o.currentPage=l}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",21),e.TgZ(38,"div",4),e.TgZ(39,"div",5),e.TgZ(40,"h1",6),e._uU(41,"Realizar Venta"),e.qZA(),e.TgZ(42,"div",7),e.TgZ(43,"div",8),e.TgZ(44,"div",22),e.TgZ(45,"div",23),e.TgZ(46,"div",10),e.TgZ(47,"ng-autocomplete",24,25),e.NdJ("selected",function(l){return o.selectEvent(l)})("inputChanged",function(l){return o.onChangeSearch(l)})("inputFocused",function(l){return o.onFocused(l)})("keyup.enter",function(l){return o.selectEvent(l)}),e.qZA(),e.YNc(49,Ue,1,1,"ng-template",null,26,e.W1O),e.YNc(51,ye,1,1,"ng-template",null,27,e.W1O),e.qZA(),e.qZA(),e.TgZ(53,"div",28),e.TgZ(54,"div",29),e.YNc(55,Pe,4,3,"div",30),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(56,"div",2),e.TgZ(57,"h4"),e._uU(58),e.ALo(59,"currency"),e.qZA(),e.qZA(),e.TgZ(60,"div",7),e.TgZ(61,"div",31),e.TgZ(62,"h4",32),e._uU(63,"Lista de Productos"),e.qZA(),e.TgZ(64,"div",33),e.TgZ(65,"form"),e.TgZ(66,"table",34),e.TgZ(67,"thead",15),e.TgZ(68,"tr",35),e.TgZ(69,"th"),e._uU(70,"Ord."),e.qZA(),e.TgZ(71,"th"),e._uU(72,"Tipo"),e.qZA(),e.TgZ(73,"th"),e._uU(74,"Detalle"),e.qZA(),e.TgZ(75,"th"),e._uU(76,"Cantidad"),e.qZA(),e.TgZ(77,"th"),e._uU(78,"Precio"),e.qZA(),e.TgZ(79,"th"),e._uU(80,"Total"),e.qZA(),e.TgZ(81,"th"),e._uU(82,"Acci\xf3n"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(83,"tbody"),e.YNc(84,Ie,25,14,"tr",16),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(85,"div",36),e.TgZ(86,"button",37),e.NdJ("click",function(){e.CHM(a);const l=e.MAs(92);return o.centerModal(l,o.products)}),e._UZ(87,"i",38),e._uU(88," Guardar "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(89,Re,24,8,"ng-template",null,39,e.W1O),e.YNc(91,ut,23,4,"ng-template",null,40,e.W1O),e.YNc(93,mt,152,0,"ng-template",null,41,e.W1O)}if(2&t){const a=e.MAs(50),r=e.MAs(52);e.xp6(1),e.Q6J("breadcrumbItems",o.breadCrumbItems),e.xp6(11),e.Q6J("ngModel",o.searchtext),e.xp6(18),e.Q6J("ngForOf",e.Dn7(31,15,e.xi3(32,19,o.listMonturasforSale,o.searchtext),(o.currentPage-1)*o.pageSize,o.currentPage*o.pageSize)),e.xp6(6),e.Q6J("collectionSize",(null==o.listMonturasforSale?null:o.listMonturasforSale.length)||0)("page",o.currentPage)("pageSize",o.pageSize)("maxSize",5),e.xp6(11),e.Q6J("data",o.listAllProducts)("searchKeyword",o.keyword)("itemTemplate",a)("notFoundTemplate",r),e.xp6(8),e.Q6J("appRole",o.role),e.xp6(3),e.hij("Total de la Venta: PEN ",e.xi3(59,22,o.getTotalCost(),"S/ "),""),e.xp6(26),e.Q6J("ngForOf",o.products),e.xp6(2),e.Q6J("disabled",!o.btnGuardar)}},directives:[$.V,s.Fj,s.JJ,s.On,f.sg,m.N9,re.YR,j.g,s._Y,s.JL,s.F,m._L,s.sg,m.jt,D.w9,s.u,m._h,f.O5,f.mk,m.Pz,m.nv,m.Vx,m.uN,m.tO,W.w5],pipes:[f.OU,X.Z,f.H9],styles:[""]}),i})();var k=d(34099),pt=d(23405),gt=d(22411),O=d(81366),se=d(65686),le=d(79204),de=d(5250),J=d(18260),ht=d(44522);let F=(()=>{class i{constructor(t){this.http=t}getVentas(){return this.http.get(J.N.urlBackend+"getAllVentas")}getVentasbySede(t){return this.http.get(J.N.urlBackend+"getAllVentasBySede/"+t)}getVentasByDate(t,o,a){return this.http.get(J.N.urlBackend+"getAllVentasByDate/"+t+"/"+o+"/"+a)}darBajaVenta(t){return this.http.put(J.N.urlBackend+"unsubscribeVentasById/"+t,t)}updatePagoCuotas(t,o){return this.http.put(J.N.urlBackend+"updatePagoCuotasVentaById/"+t,o)}getVentasEliminadasbySede(t){return this.http.get(J.N.urlBackend+"getAllVentasEliminadasBySede/"+t)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(ht.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ce=(()=>{class i{constructor(t,o,a){this.pipe=t,this.ventaService=o,this.usuarioService=a,this._loading$=new k.X(!0),this._search$=new pt.xQ,this._total$=new k.X(0),this._mostrar$=new k.X(!1),this._ventas$=new k.X([]),this.ventaList=[],this._state={page:1,pageSize:10,searchTerm:"",sortColumn:"",sortDirection:""},this.getAllVentas()}get transactions$(){return this._ventas$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get page(){return this._state.page}get pageSize(){return this._state.pageSize}get searchTerm(){return this._state.searchTerm}get mostrar(){return this._mostrar$.asObservable()}set page(t){this._set({page:t})}set pageSize(t){this._set({pageSize:t})}set searchTerm(t){this._set({searchTerm:t})}set sortColumn(t){this._set({sortColumn:t})}set sortDirection(t){this._set({sortDirection:t})}_set(t){Object.assign(this._state,t),this._search$.next()}updateTable(t){this.ventaList=t,this._mostrar$.next(!0),this._search$.pipe((0,O.b)(()=>this._loading$.next(!0)),(0,se.b)(200),(0,le.w)(()=>this._search()),(0,de.g)(200),(0,O.b)(()=>this._loading$.next(!1))).subscribe(o=>{this._ventas$.next(o.transactions),this._total$.next(o.total)}),this._search$.next()}_search(){const{sortColumn:t,sortDirection:o,pageSize:a,page:r,searchTerm:l}=this._state;let h=function(i,n,t){return""===t||""===n?i:[...i].sort((o,a)=>{const r=((i,n)=>i<n?-1:i>n?1:0)(o[n],a[n]);return"asc"===t?r:-r})}(this.ventaList,t,o);h=h.filter(S=>function(i,n,t){return i.nombre_vendedor.toLowerCase().includes(n)||String(i.tipo_venta[0].precio_total).toLowerCase().includes(n.toLowerCase())||i.fecha_creacion_venta.toLocaleString().includes(n)}(S,l));const N=h.length;return h=h.slice((r-1)*a,(r-1)*a+a),(0,gt.of)({transactions:h,total:N})}getAllVentas(){this.ventaService.getVentasbySede(this.usuarioService.getSedebyUser()).subscribe(t=>{this.ventaList=t,this._mostrar$.next(!0),this._search$.pipe((0,O.b)(()=>this._loading$.next(!0)),(0,se.b)(200),(0,le.w)(()=>this._search()),(0,de.g)(200),(0,O.b)(()=>this._loading$.next(!1))).subscribe(o=>{this._ventas$.next(o.transactions),this._total$.next(o.total)}),this._search$.next()})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(f.JJ),e.LFG(F),e.LFG(R.i))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const bt={asc:"desc",desc:"","":"asc"};let Ct=(()=>{class i{constructor(){this.sortable="",this.direction="",this.sort=new e.vpe}rotate(){this.direction=bt[this.direction],this.sort.emit({column:this.sortable,direction:this.direction})}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=e.lG2({type:i,selectors:[["th","sortable",""]],hostVars:4,hostBindings:function(t,o){1&t&&e.NdJ("click",function(){return o.rotate()}),2&t&&e.ekj("asc","asc"===o.direction)("desc","desc"===o.direction)},inputs:{sortable:"sortable",direction:"direction"},outputs:{sort:"sort"}}),i})();var At=d(7082),Tt=d.n(At),ue=d(19039),Q=d(45788);function xt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",35),e.TgZ(1,"form",36),e.TgZ(2,"div",37),e.TgZ(3,"ng-select",38),e.NdJ("change",function(){return e.CHM(t),e.oxw().changeSedes()}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.formSedes),e.xp6(2),e.s9C("formControlName",t.nombre_sedes),e.Q6J("items",t.listSedes)}}function qt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",39),e.TgZ(1,"div",40),e.TgZ(2,"input",41),e.NdJ("click",function(){return e.CHM(t),e.oxw().exportarVentas()}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("disabled",!t.formDateRange.valid)}}function St(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",42),e.TgZ(1,"div",6),e.TgZ(2,"form",36),e.TgZ(3,"div",43),e._UZ(4,"input",44),e._UZ(5,"input",44),e.TgZ(6,"button",45),e.NdJ("click",function(){return e.CHM(t),e.oxw().filterDateRange()}),e._UZ(7,"i",46),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.formDateRange),e.xp6(2),e.s9C("formControlName",t.fechaDesde),e.xp6(1),e.s9C("formControlName",t.fechaHasta)}}const me=function(i){return{"bg-soft-danger":i}};function Nt(i,n){if(1&i&&(e.TgZ(0,"td"),e.TgZ(1,"span",56),e._uU(2,"Deuda \xa0"),e.qZA(),e.TgZ(3,"span",57),e._uU(4),e.qZA(),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngClass",e.VKq(2,me,t.tipo_venta[0].deuda>0)),e.xp6(1),e.hij(" ",t.tipo_venta[0].deuda," ")}}function Ut(i,n){1&i&&(e.TgZ(0,"td"),e.TgZ(1,"span",58),e._uU(2,"Pagado"),e.qZA(),e.qZA())}function yt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",59),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,r=e.oxw(),l=e.MAs(64);return r.centerModalActualizar(l,a)}),e._UZ(1,"i",60),e.qZA()}}function Pt(i,n){1&i&&e._UZ(0,"i",63)}function Mt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",61),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit;return e.oxw().eliminar(a)}),e.YNc(1,Pt,1,0,"i",62),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("appRole",t.role)}}function Jt(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",47),e.TgZ(1,"td"),e._UZ(2,"ngb-highlight",48),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"ngb-highlight",48),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e.TgZ(7,"div",49),e.TgZ(8,"span",50),e._uU(9),e.qZA(),e.qZA(),e._UZ(10,"ngb-highlight",48),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"ngb-highlight",48),e.ALo(13,"currency"),e.qZA(),e.TgZ(14,"td"),e._UZ(15,"ngb-highlight",48),e.qZA(),e.YNc(16,Nt,5,4,"td",51),e.YNc(17,Ut,3,0,"td",51),e.TgZ(18,"td"),e.TgZ(19,"div"),e.TgZ(20,"button",52),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().createPDF(r)}),e._uU(21,"Pdf "),e._UZ(22,"i",53),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"td"),e.YNc(24,yt,2,0,"a",54),e.YNc(25,Mt,2,1,"a",55),e.qZA(),e.qZA()}if(2&i){const t=n.$implicit,o=n.index,a=e.oxw();e.xp6(2),e.Q6J("result",o+1)("term",a.service.searchTerm),e.xp6(2),e.Q6J("result",e.xi3(5,15,t.fecha_creacion_venta,"dd/MM/yyyy"))("term",a.service.searchTerm),e.xp6(5),e.hij(" ",t.nombre_cliente.charAt(0)," "),e.xp6(1),e.Q6J("result",t.nombre_cliente.toUpperCase())("term",a.service.searchTerm),e.xp6(2),e.Q6J("result",e.xi3(13,18,t.tipo_venta[0].precio_total,"S/ "))("term",a.service.searchTerm),e.xp6(3),e.Q6J("result",t.nombre_vendedor.toUpperCase())("term",a.service.searchTerm),e.xp6(1),e.Q6J("ngIf",t.tipo_venta[0].deuda>0),e.xp6(1),e.Q6J("ngIf",0==t.tipo_venta[0].deuda),e.xp6(7),e.Q6J("ngIf",0!=t.tipo_venta[0].deuda),e.xp6(1),e.Q6J("appRole",a.role)}}function Et(i,n){1&i&&(e.TgZ(0,"div",2),e.TgZ(1,"div",19),e.TgZ(2,"div",64),e.TgZ(3,"a",65),e._UZ(4,"i",66),e._uU(5," Cargando "),e.qZA(),e.qZA(),e.qZA(),e.qZA())}function Vt(i,n){1&i&&(e.TgZ(0,"div",56),e._uU(1," Campo requerido "),e.qZA())}function wt(i,n){1&i&&(e.TgZ(0,"div",56),e._uU(1," Ingrese solo n\xfameros "),e.qZA())}function zt(i,n){if(1&i&&(e.TgZ(0,"div",56),e.YNc(1,Vt,2,0,"div",82),e.YNc(2,wt,2,0,"div",82),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.formCreditoActualizacion.controls.campoCantidadRecibidaCreditoActualizacion.errors?null:t.formCreditoActualizacion.controls.campoCantidadRecibidaCreditoActualizacion.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.formCreditoActualizacion.controls.campoCantidadRecibidaCreditoActualizacion.errors?null:t.formCreditoActualizacion.controls.campoCantidadRecibidaCreditoActualizacion.errors.pattern)}}function It(i,n){1&i&&(e.TgZ(0,"div",56),e._uU(1," Campo requerido "),e.qZA())}function Dt(i,n){if(1&i&&(e.TgZ(0,"div",56),e.YNc(1,It,2,0,"div",82),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.formCreditoActualizacion.controls.campoMetodoPagoCreditoActualizacion.errors?null:t.formCreditoActualizacion.controls.campoMetodoPagoCreditoActualizacion.errors.required)}}function Lt(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"This value is required."),e.qZA())}function Rt(i,n){if(1&i&&(e.TgZ(0,"div",103),e.YNc(1,Lt,2,0,"span",51),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.form.title.errors.required)}}function kt(i,n){if(1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"th",104),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.qZA()),2&i){const t=n.$implicit,o=n.index;e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(e.xi3(5,4,t.cantidad_recibida,"S/ ")),e.xp6(3),e.Oqu(t.metodo_pago),e.xp6(2),e.Oqu(e.xi3(10,7,t.fecha_pago,"dd/MM/yyyy hh:mm:ss"))}}const H=function(i){return{"is-invalid":i}};function Ot(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",67),e.TgZ(1,"h5",68),e._uU(2,"Actualizar Venta - Al Credito"),e.qZA(),e.TgZ(3,"button",69),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e.qZA(),e.qZA(),e.TgZ(4,"div",70),e.TgZ(5,"div",71),e.TgZ(6,"form",36),e.TgZ(7,"div",2),e.TgZ(8,"div",72),e.TgZ(9,"div",73),e.TgZ(10,"label",74),e._uU(11,"Nombres y Apellidos del Cliente"),e.qZA(),e.TgZ(12,"h5"),e._uU(13),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",72),e.TgZ(15,"div",75),e.TgZ(16,"div",76),e.TgZ(17,"div",77),e._uU(18,"Deuda \xa0"),e.qZA(),e.TgZ(19,"div",78),e._uU(20),e.ALo(21,"currency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(22,"div",79),e.TgZ(23,"div",2),e.TgZ(24,"div",80),e.TgZ(25,"div",73),e.TgZ(26,"label",74),e._uU(27,"Cantidad Recibida"),e.qZA(),e.TgZ(28,"input",81),e.NdJ("change",function(a){return e.CHM(t),e.oxw().updatePago(a)}),e.qZA(),e.YNc(29,zt,3,2,"div",82),e.qZA(),e.qZA(),e.TgZ(30,"div",80),e.TgZ(31,"div",73),e.TgZ(32,"label",83),e._uU(33,"M\xe9todo"),e.qZA(),e._UZ(34,"ng-select",84),e.YNc(35,Dt,2,1,"div",82),e.qZA(),e.qZA(),e.TgZ(36,"div",80),e.TgZ(37,"div",73),e.TgZ(38,"label",74),e._uU(39,"Fecha"),e.qZA(),e._UZ(40,"input",85),e.YNc(41,Rt,2,1,"div",86),e.qZA(),e.qZA(),e.qZA(),e.TgZ(42,"div",2),e.TgZ(43,"div",19),e.TgZ(44,"div",73),e.TgZ(45,"label",74),e._uU(46),e.qZA(),e.TgZ(47,"div",2),e.TgZ(48,"div",87),e.TgZ(49,"div",88),e.TgZ(50,"table",89),e.TgZ(51,"thead"),e.TgZ(52,"tr"),e.TgZ(53,"th",90),e._uU(54,"N\xba Cuotas"),e.qZA(),e.TgZ(55,"th"),e._uU(56,"Monto"),e.qZA(),e.TgZ(57,"th"),e._uU(58,"M\xe9todo"),e.qZA(),e.TgZ(59,"th"),e._uU(60,"Fecha"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(61,"tbody"),e.YNc(62,kt,11,10,"tr",91),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(63,"div",2),e.TgZ(64,"div",19),e.TgZ(65,"label",92),e._uU(66,"Montos:"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(67,"div",2),e.TgZ(68,"div",80),e.TgZ(69,"div",73),e.TgZ(70,"label",74),e._uU(71,"Total"),e.qZA(),e._UZ(72,"input",93),e.qZA(),e.qZA(),e.TgZ(73,"div",80),e.TgZ(74,"div",73),e.TgZ(75,"label",74),e._uU(76,"Pago"),e.qZA(),e._UZ(77,"input",94),e.qZA(),e.qZA(),e.TgZ(78,"div",80),e.TgZ(79,"div",73),e.TgZ(80,"label",74),e._uU(81,"Deuda"),e.qZA(),e._UZ(82,"input",95),e.qZA(),e.qZA(),e.qZA(),e.TgZ(83,"div",2),e.TgZ(84,"div",96),e.TgZ(85,"div",97),e.TgZ(86,"label",98),e._uU(87,"Observaciones"),e.qZA(),e._UZ(88,"textarea",99),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(89,"div",100),e.TgZ(90,"button",101),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeEventModal()}),e._uU(91," Cerrar "),e.qZA(),e.TgZ(92,"button",102),e.NdJ("click",function(){return e.CHM(t),e.oxw().guardarActualizacionDeuda()}),e._uU(93," Registrar Venta "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.formCreditoActualizacion),e.xp6(7),e.Oqu(t.usuario.nombre),e.xp6(6),e.Q6J("ngClass",e.VKq(25,me,!0)),e.xp6(1),e.hij(" ",e.xi3(21,22,t.usuario.deuda,"S/ ")," "),e.xp6(8),e.s9C("formControlName",t.cantidadRecibida_CreditoActualizacion),e.xp6(1),e.Q6J("ngIf",t.formCreditoActualizacion.controls.campoCantidadRecibidaCreditoActualizacion.invalid&&(t.formCreditoActualizacion.controls.campoCantidadRecibidaCreditoActualizacion.dirty||t.formCreditoActualizacion.controls.campoCantidadRecibidaCreditoActualizacion.touched)),e.xp6(5),e.s9C("formControlName",t.metodoPagoCreditoActualizacion),e.Q6J("items",t.listMetodosPagos),e.xp6(1),e.Q6J("ngIf",t.formCreditoActualizacion.controls.campoMetodoPagoCreditoActualizacion.invalid&&(t.formCreditoActualizacion.controls.campoMetodoPagoCreditoActualizacion.dirty||t.formCreditoActualizacion.controls.campoMetodoPagoCreditoActualizacion.touched)),e.xp6(5),e.s9C("formControlName",t.fechaVenta_CreditoActualizacion),e.Q6J("ngClass",e.VKq(27,H,t.submitted&&t.form.title.errors)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.form.title.errors),e.xp6(5),e.hij("Informaci\xf3n de Pagos: ",t.usuario.listDeudas[0].cuotas," cuotas"),e.xp6(16),e.Q6J("ngForOf",t.usuario.listDeudas),e.xp6(10),e.s9C("formControlName",t.precioTotal_CreditoActualizacion),e.Q6J("ngClass",e.VKq(29,H,t.submitted&&t.form.title.errors)),e.xp6(5),e.s9C("formControlName",t.pago_CreditoActualizacion),e.Q6J("ngClass",e.VKq(31,H,t.submitted&&t.form.title.errors)),e.xp6(5),e.s9C("formControlName",t.cambio_CreditoActualizacion),e.Q6J("ngClass",e.VKq(33,H,t.submitted&&t.form.title.errors)),e.xp6(6),e.s9C("formControlName",t.observaciones_CreditoActualizacion),e.xp6(4),e.Q6J("disabled",!t.formCreditoActualizacion.valid)}}function Qt(i,n){if(1&i&&(e.TgZ(0,"div",17),e.TgZ(1,"form",18),e.TgZ(2,"div",19),e._UZ(3,"ng-select",20),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.formSedes),e.xp6(2),e.s9C("formControlName",t.nombre_sedes),e.Q6J("items",t.listSedes)}}L().vfs=ae.I.vfs;const Bt=[{path:"addsale",component:_t,data:{role:["Vendedor","Admin"]},canActivate:[Y.a]},{path:"listsales",component:(()=>{class i{constructor(t,o,a,r,l,h,N){this.service=t,this.fb=o,this.ventasService=a,this.modalService=r,this.customerService=l,this.usuarioService=h,this.ventaService=N,this.role="Admin",this.nombre_sedes="campoSede",this.idSede="",this.mostrarSpinner=!1,this.submitted_CreditoActualizacion=!1,this.cantidadRecibida_CreditoActualizacion="campoCantidadRecibidaCreditoActualizacion",this.fechaVenta_CreditoActualizacion="campoFechaVentaCreditoActualizacion",this.usuario_CreditoActualizacion="campoUsuarioCreditoActualizacion",this.nombreCreditoActualizacion="campoNombreCreditoActualizacion",this.precioTotal_CreditoActualizacion="campoPrecioTotalCreditoActualizacion",this.pago_CreditoActualizacion="campoPagoCreditoActualizacion",this.cambio_CreditoActualizacion="campoCambioCreditoActualizacion",this.observaciones_CreditoActualizacion="campoObservacionesCreditoActualizacion",this.metodoPagoCreditoActualizacion="campoMetodoPagoCreditoActualizacion",this.numberPattern="[0-9]+",this.activePago=1,this.listMetodosPagos=["F\xedsico","Yape","Plin","Interbancario"],this.exampleOptions={altInputClass:"form-control",locale:Tt().es},this.fechaDesde="campoFechaDesde",this.fechaHasta="campoFechaHasta",this.venta=new ie,this.tipoPago=[],this.decimalPattern=/^\d+(\.\d{1,2})?$/,this.excelVentas=[],this.transactions$=t.transactions$,this.total$=t.total$,t.mostrar.subscribe(S=>{this.mostrarSpinner=S})}ngOnInit(){this.breadCrumbItems=[{label:"Venta"},{label:"Lista de Ventas",active:!0}],this.getListSedes(),this.crearFormulario()}getListSedes(){this.listSedes=JSON.parse(localStorage.getItem("sedes")),this.idSede=this.usuarioService.getSedebyUser()}onSort({column:t,direction:o}){this.headers.forEach(a=>{a.sortable!==t&&(a.direction="")}),this.service.sortColumn=t,this.service.sortDirection=o}centerModalActualizar(t,o){this.crearFormularioActualizar(),this.fechaVenta=new Date(Date.now()),this.usuario={nombre:o.nombre_cliente,deuda:o.tipo_venta[0].deuda,listDeudas:o.tipo_venta},this.venta.id_ventas=o.id_ventas,this.venta.id_cliente=o.id_cliente,this.tipoPago=o.tipo_venta,this.g(this.precioTotal_CreditoActualizacion).setValue(this.usuario.deuda.toFixed(2)),this.modalService.open(t,{centered:!0,windowClass:"modal-holder"}),this.g(this.fechaVenta_CreditoActualizacion).setValue(this.fechaVenta.toLocaleDateString())}closeEventModal(){this.modalService.dismissAll()}saveEvent(){this.submitted_CreditoActualizacion=!0}crearFormulario(){this.formDateRange=this.fb.group({[this.fechaDesde]:[null,[s.kI.required]],[this.fechaHasta]:[]}),this.formSedes=this.fb.group({[this.nombre_sedes]:[this.idSede]})}crearFormularioActualizar(){this.formCreditoActualizacion=this.fb.group({[this.cantidadRecibida_CreditoActualizacion]:[null,[s.kI.required,s.kI.pattern(this.decimalPattern)]],[this.fechaVenta_CreditoActualizacion]:[{value:null,disabled:!0}],[this.usuario_CreditoActualizacion]:[null],[this.precioTotal_CreditoActualizacion]:[{value:null,disabled:!0}],[this.pago_CreditoActualizacion]:[{value:null,disabled:!0}],[this.cambio_CreditoActualizacion]:[{value:null,disabled:!0}],[this.observaciones_CreditoActualizacion]:[null],[this.metodoPagoCreditoActualizacion]:[null,[s.kI.required]]})}g(t){return this.formCreditoActualizacion.get(t)}updatePago(t){this.g(this.pago_CreditoActualizacion).setValue(this.g(this.cantidadRecibida_CreditoActualizacion).value);const o=Number((0,y.NM)(this.g(this.cantidadRecibida_CreditoActualizacion).value-this.usuario.deuda,1).toFixed(2));this.g(this.cambio_CreditoActualizacion).setValue(Math.abs(o))}guardarActualizacionDeuda(){if(this.formCreditoActualizacion.valid){this.venta.id_vendedor=this.usuarioService.getUser().id_usuario,this.venta.nombre_vendedor=this.usuarioService.getUser().nombres+" "+this.usuarioService.getUser().apellidos,this.venta.id_sede=this.usuarioService.getSedebyUser();let t=0;t=(0,y.NM)(this.tipoPago[0].deuda-this.g(this.cantidadRecibida_CreditoActualizacion).value,1);const o={forma_pago:"credito",cantidad_recibida:Number(this.g(this.cantidadRecibida_CreditoActualizacion).value),deuda:t,cuotas:this.tipoPago[0].cuotas,precio_total:this.tipoPago[0].precio_total,metodo_pago:this.g(this.metodoPagoCreditoActualizacion).value,fecha_pago:new Date(Date.now()),observaciones:this.g(this.observaciones_CreditoActualizacion).value};let a=[];if(this.tipoPago.length+1==Number(this.tipoPago[0].cuotas)&&t>0)return void(0,_.H)("error","Es su \xfaltima cuota, tiene que cancelar la totalidad");if(Number(this.g(this.cantidadRecibida_CreditoActualizacion).value>this.g(this.precioTotal_CreditoActualizacion).value))return void(0,_.H)("error","El pago debe ser menor a la deuda");t<=0?(o.deuda=0,a.push(o),a.push(...this.tipoPago),this.venta.tipo_venta=a,U().fire({title:"\xbfEst\xe1 seguro que desea cancelar la totalidad de la deuda?",text:"No se podr\xe1 revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Si, cancelar deuda!"}).then(r=>{r.value?((0,_.H)("loading","Cargando..."),this.ventasService.updatePagoCuotas(this.venta.id_ventas,this.venta).subscribe(l=>{(0,_.H)("close",null),(0,_.H)("success","Venta completada"),this.modalService.dismissAll(),this.updateListVentas()},l=>{(0,_.H)("close",null),(0,_.H)("error","Error en la conexi\xf3n")})):r.dismiss===U().DismissReason.cancel&&U().fire("Cancelado","Venta no eliminada","error")})):(a.push(o),a.push(...this.tipoPago),this.venta.tipo_venta=a,this.ventasService.updatePagoCuotas(this.venta.id_ventas,this.venta).subscribe(r=>{this.modalService.dismissAll(),this.updateListVentas()}))}}f(t){return this.formDateRange.get(t)}filterDateRange(){if(this.formDateRange.valid){this.idSede=this.fS(this.nombre_sedes).value;let o,t=new Date(this.f(this.fechaDesde).value+"T00:00");null!=this.f(this.fechaHasta).value?o=new Date(this.f(this.fechaHasta).value+"T23:59"):(o=new Date(Date.now()),o.setHours(23,59,0)),this.ventasService.getVentasByDate(t,o,this.idSede).subscribe(a=>{this.service.updateTable(a)})}}eliminar(t){U().fire({title:"\xbfEst\xe1 seguro que desea eliminar la venta?",text:"No se podr\xe1 revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Si, eliminar!"}).then(o=>{o.value?((0,_.H)("loading","Cargando..."),this.ventasService.darBajaVenta(t.id_ventas).subscribe(a=>{(0,_.H)("close",null),(0,_.H)("success","Venta eliminada"),this.updateListVentas()},a=>{(0,_.H)("close",null),(0,_.H)("error","Error en la conexi\xf3n")})):o.dismiss===U().DismissReason.cancel&&U().fire("Cancelado","Venta no eliminada","error")})}updateListVentas(){this.ventasService.getVentasbySede(this.idSede).subscribe(t=>{this.service.updateTable(t)})}createPDF(t){this.customerService.getAllClientbyId(t.id_cliente).subscribe(o=>{this.generatePDF(t,o[0])})}generatePDF(t,o){return(0,oe.mG)(this,void 0,void 0,function*(){var l=new Date(t.fecha_creacion_venta).toLocaleDateString("en-GB"),h=new Date(t.fecha_creacion_venta).toLocaleDateString("es-CL",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),N=new Date(t.fecha_creacion_venta).toLocaleTimeString("es-CL",{timeZone:"America/Bogota",hour12:!0,hour:"numeric",minute:"2-digit",second:"2-digit"}),M=o.nombres+" "+o.apellidos,p=o.fecha_nacimiento?new Date(o.fecha_nacimiento).toLocaleDateString("en-GB"):"Sin especificar.",w=o.direccion?o.direccion:"Sin especificar.",g=o.email?o.email:"Sin especificar.",E=o.telefono?o.telefono:"Sin especificar.",z=[];const he={pageSize:"A4",pageMargins:[40,60,40,60],content:[{style:"tableMargin",table:{widths:["*","*"],body:[[{image:yield(0,y.up)("/assets/images/logo-dark.png"),width:150},{text:"",style:"tableHeader",rowSpan:3,alignment:"right"}],[{text:"Calle Santa Marta 218, Arequipa"},{}],[{text:"raulcg1234@hotmail.com "},{}],[{text:"955 739 464"},{}]]},layout:"noBorders"},{style:"tableMargin",table:{widths:["*","*"],body:[[{text:"Facturado a:",style:"tableHeader"},{text:"Fecha de la Boleta:",style:"tableHeader",alignment:"right"}],[{text:M,style:"subtitulo"},{text:l,style:"contenido",alignment:"right"}],[{text:"Fecha de Nacimiento: "+p,style:"contenido"},{}],[{text:"Direcci\xf3n: "+w,style:"contenido"},{}],[{text:"Correo: "+g,style:"contenido"},{}],[{text:"Telefono: "+E,style:"contenido"},{}]]},layout:"noBorders"},{text:"Resumen del pedido:",style:"subtitulo"},(b=z,A=["num_orden","detalle","precio","cantidad","total"],C=function(){var A,C,b=0,T=0,c=0;if(t.list_monturas.length>0)for(var u=0;u<t.list_monturas.length;u++)c+=A=t.list_monturas[u].precio_montura_v*t.list_monturas[u].cant_vendida,z.push({num_orden:b+=1,detalle:t.list_monturas[u].marca,precio:t.list_monturas[u].precio_montura_v,cantidad:t.list_monturas[u].cant_vendida,total:A});if(t.list_lunas.length>0)for(u=0;u<t.list_lunas.length;u++)c+=C=t.list_lunas[u].precio_luna_v*t.list_lunas[u].cant_vendida,z.push({num_orden:b+=1,detalle:t.list_lunas[u].material,precio:t.list_lunas[u].precio_luna_v,cantidad:t.list_lunas[u].cant_vendida,total:C});if(t.list_accesorios.length>0)for(u=0;u<t.list_accesorios.length;u++)c+=T=t.list_accesorios[u].precio_accesorio_v*t.list_accesorios[u].cant_vendida,z.push({num_orden:b+=1,detalle:t.list_accesorios[u].nombre_accesorio,precio:t.list_accesorios[u].precio_accesorio_v,cantidad:t.list_accesorios[u].cant_vendida,total:T});return c}(),{style:"tableMargin",color:"#444",table:{widths:[25,"*",63,60,63],heights:[20,20,20,20],headerRows:1,body:function(b,A,C){var T=[];T.push([{text:"No.",style:"tableHeader",alignment:"center"},{text:"Detalle",style:"tableHeader",alignment:"center"},{text:"Precio",style:"tableHeader",alignment:"center"},{text:"Cantidad",style:"tableHeader",alignment:"center"},{text:"Total",style:"tableHeader",alignment:"center"}]),b.forEach(function(u){var B=[];A.forEach(function(Gt){B.push(u[Gt].toString())}),T.push(B)});var c=(0,y.NM)(C,1);return T.push([{text:"",border:[!1,!1,!1,!1],colSpan:2},{},{text:"Total:",style:"tableHeader",alignment:"right",colSpan:2},{},{text:"S/ "+c,style:"contenido",alignment:"right"}]),T}(b,A,C)}}),{text:[,{text:"Fecha de Entrega: ",style:"textBold"},h,"   ",{text:"Hora: ",style:"textBold"},N]},{text:"Nota:",style:"subtitulo2"},{text:"Todo trabajo se efectuara con un adelanto del 50%.",style:"contenido2",alignment:"justify"},{text:"La empresa no se responsabiliza de los pedidos no recogidos despu\xe9s de un mes.",style:"contenido2",alignment:"justify"}],styles:{subtitulo:{bold:!0,fontSize:13,color:"black",margin:[0,10,0,5]},subtitulo2:{bold:!0,fontSize:10,color:"black",margin:[0,10,0,5]},contenido:{fontSize:12},contenido2:{fontSize:8},textBold:{fontSize:12,bold:!0},header:{fontSize:17,bold:!0,margin:[0,0,0,10]},subheader:{fontSize:13,bold:!0,margin:[0,10,0,5]},subtitle:{fontSize:12,bold:!0,margin:[0,10,0,5]},tableMargin:{margin:[0,15,0,15]},tableOpacityExample:{margin:[0,5,0,15],fillColor:"blue",fillOpacity:.3},tableHeader:{bold:!0,fontSize:13,color:"black"}}};var b,A,C;L().createPdf(he).open()})}fS(t){return this.formSedes.get(t)}changeSedes(){this.idSede=this.fS(this.nombre_sedes).value,this.getListVentas(this.idSede)}getListVentas(t){this.ventasService.getVentasbySede(t).subscribe(o=>{this.service.updateTable(o)})}exportarVentas(){if(this.formSedes.valid&&this.formDateRange.valid){let t=[];const o="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8";this.idSede=this.fS(this.nombre_sedes).value;let l,r=new Date(this.f(this.fechaDesde).value+"T00:00");null!=this.f(this.fechaHasta).value?l=new Date(this.f(this.fechaHasta).value+"T23:59"):(l=new Date(Date.now()),l.setHours(23,59,0)),this.ventaService.getVentasByDate(r,l,this.idSede).subscribe(h=>{this.excelVentas=h,t=this.excelVentas.map(Z=>{let M=Z.list_accesorios.map(g=>({"PRECIO VENTA":g.precio_accesorio_v,"PRECIO COMPRA":g.precio_accesorio_c,"CANTIDAD VENDIDA":g.cant_vendida,NOMBRE:g.nombre_accesorio,"SUMA TOTAL":g.precio})),p=Z.list_monturas.map(g=>({"PRECIO VENTA":g.precio_montura_v,"PRECIO COMPRA":g.precio_montura_c,"CANTIDAD VENDIDA":g.cant_vendida,MARCA:g.marca,MATERIAL:g.material,COLOR:g.color,"SUMA TOTAL":g.precio})),w=Z.list_lunas.map(g=>({"PRECIO VENTA":g.precio_luna_v,"PRECIO COMPRA":g.precio_luna_c,"CANTIDAD VENDIDA":g.cant_vendida,MATERIAL:g.material,"SUMA TOTAL":g.precio}));return{FECHA:new Date(Z.fecha_creacion_venta).toLocaleDateString("en-GB"),"NOMBRE CLIENTE":Z.nombre_cliente,ACCESORIOS:JSON.stringify(M),LUNAS:JSON.stringify(w),MONTURAS:JSON.stringify(p),TOTAL:Z.tipo_venta[0].precio_total,USUARIO:Z.nombre_vendedor.toUpperCase(),VENDEDOR:Z.nombre_jalador?Z.nombre_jalador.toUpperCase():null,"ENCARGADO MEDICION":Z.encargado_medicion?Z.encargado_medicion.toUpperCase():null,"FORMA DE PAGO":Z.tipo_venta[0].forma_pago,ESTADO:Z.tipo_venta[0].deuda>0?"DEUDA":"PAGADO"}});const S={Sheets:{hoja:Q.P6.json_to_sheet(t)},SheetNames:["hoja"]},V=Q.cW(S,{bookType:"xlsx",type:"array"}),v=new Blob([V],{type:o}),P=this.listSedes.find(Z=>Z.id_sede==this.fS(this.nombre_sedes).value);(0,ue.Z)(v,"ventas_"+P.nombre_sede)})}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(ce),e.Y36(s.qu),e.Y36(F),e.Y36(m.FF),e.Y36(ne.$),e.Y36(R.i),e.Y36(F))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-list-sales"]],viewQuery:function(t,o){if(1&t&&e.Gf(Ct,5),2&t){let a;e.iGM(a=e.CRH())&&(o.headers=a)}},features:[e._Bn([ce,f.JJ])],decls:65,vars:22,consts:[[1,"container-fluid"],["title","Ventas",3,"breadcrumbItems"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-inline"],[1,"search-box","ml-2"],[1,"position-relative"],["type","text","placeholder","Buscar venta","name","searchTerm","aria-controls","tickets-table",1,"form-control","border-light","rounded",3,"ngModel","ngModelChange"],[1,"uil","uil-search","search-icon"],["role","toolbar",1,"btn-toolbar"],["class","col-12 col-md-6 d-grid mb-2 chat-search-box px-1",4,"appRole"],["class","col-12 col-md-6 d-grid",4,"appRole"],[1,"row","md-2"],["class","col-md-6 d-grid mb-2 chat-search-box px-1",4,"appRole"],[1,"col-md-6"],[1,"dataTables_length","text-md-end"],[1,"d-inline-flex","align-items-center"],["name","pageSize",1,"custom-select","custom-select-sm","form-control","form-control-sm","form-select","form-select-sm",3,"ngModel","ngModelChange"],[3,"ngValue"],[1,"col-12"],[1,"table-responsive","mb-4"],[1,"table","datatables","table-centered","table-nowrap","mb-0","align-middle","table-card-list",2,"border-spacing","0 12px","width","100%"],[1,"bg-transparent"],["scope","col","sortable","orden",3,"sort"],["scope","col","sortable","fecha_creacion_venta",3,"sort"],["scope","col","sortable","nombre_cliente",3,"sort"],["scope","col","sortable","",3,"sort"],["scope","col","sortable","nombre_vendedor",3,"sort"],[2,"width","170px"],["class","odd",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"row","justify-content-md-between","align-items-md-center"],[1,"text-md-end","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","maxSize","rotate","boundaryLinks","pageChange"],["centerDataModalActualizarVenta",""],[1,"col-12","col-md-6","d-grid","mb-2","chat-search-box","px-1"],[3,"formGroup"],["ngbDropdown",""],["placeholder","Seleccione la sede","bindValue","id_sede","bindLabel","nombre_sede",3,"items","formControlName","change"],[1,"col-12","col-md-6","d-grid"],[1,"btn-group","mb-2"],["type","button","value","Descargar Archivo",1,"btn","btn-primary","btn-block",3,"disabled","click"],[1,"col-md-6","d-grid","mb-2","chat-search-box","px-1"],[1,"input-daterange","input-group"],["type","date","id","billing-fechanacimiento","placeholder","Seleccione la fecha",1,"form-control",3,"formControlName"],["type","button",1,"btn","btn-primary",3,"click"],[1,"mdi","mdi-filter-variant"],[1,"odd"],[3,"result","term"],[1,"avatar-xs","d-inline-block","me-2"],[1,"avatar-title","rounded-circle","bg-light","text-body"],[4,"ngIf"],[1,"btn","btn-light","btn-sm","w-xs",3,"click"],[1,"uil","uil-download-alt","ms-2"],["class","px-3 text-primary","placement","top","ngbTooltip","Editar",3,"click",4,"ngIf"],["class","px-3 text-danger","placement","top","ngbTooltip","Eliminar",3,"click",4,"appRole"],[1,"text-danger"],[1,"badge","rounded-pill","bg-soft-success","font-size-12",3,"ngClass"],[1,"text-success"],["placement","top","ngbTooltip","Editar",1,"px-3","text-primary",3,"click"],[1,"uil","uil-pen","font-size-18"],["placement","top","ngbTooltip","Eliminar",1,"px-3","text-danger",3,"click"],["class","uil uil-trash-alt font-size-18",4,"appRole"],[1,"uil","uil-trash-alt","font-size-18"],[1,"text-center","my-3"],["href","javascript:void(0);",1,"text-primary"],[1,"mdi","mdi-loading","mdi-spin","font-size-20","align-middle","me-2"],[1,"modal-header"],["id","modal-title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","p-4"],[1,"col-lg-14"],[1,"col-sm-6"],[1,"mb-3"],[1,"control-label"],[1,"text-muted","text-sm-end"],[1,"mt-4"],[1,"text-danger","font-size-16"],[1,"badge","rounded-pill","bg-soft-success","font-size-16",3,"ngClass"],[1,"border-top","pt-4"],[1,"col-4"],["placeholder","Cantidad en soles","type","text","name","nameCantidadRecibidaCredito",1,"form-control",3,"formControlName","change"],["class","text-danger",4,"ngIf"],[1,"form-label"],["name","selectMetodo","placeholder","Seleccione",3,"items","formControlName"],["placeholder","Seleccione la fecha","type","text","name","nameFechaRegistroCredito",1,"form-control",3,"formControlName","ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"col-sm-12"],[1,"table-responsive"],[1,"table","table-sm","m-0","table-centered"],[2,"width","77px"],[4,"ngFor","ngForOf"],[1,"control-label",2,"text-align","left"],["placeholder","S/ 000.00","type","text","name","nameTotalCredito",1,"form-control",3,"formControlName","ngClass"],["placeholder","S/ 000.00","type","text","name","namePagoCredito",1,"form-control",3,"formControlName","ngClass"],["placeholder","S/ 000.00","type","text","name","nameCambioCredito",1,"form-control",3,"formControlName","ngClass"],[1,"col-lg-12"],[1,"mb-4"],["for","billing-observaciones",1,"form-label"],["id","billing-observaciones","rows","3","placeholder","Ingrese las observaciones",1,"form-control",3,"formControlName"],[1,"text-end","mt-2"],["type","button",1,"btn","btn-danger",3,"click"],["type","submit","id","btn-save-event",1,"btn","btn-success","ms-1",3,"disabled","click"],[1,"invalid-feedback"],["scope","row"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-page-title",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"div",6),e.TgZ(7,"input",7),e.NdJ("ngModelChange",function(r){return o.service.searchTerm=r}),e.qZA(),e._UZ(8,"i",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",3),e.TgZ(10,"div"),e.TgZ(11,"div",9),e.YNc(12,xt,4,3,"div",10),e.YNc(13,qt,3,1,"div",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",12),e.YNc(15,St,8,3,"div",13),e.TgZ(16,"div",14),e.TgZ(17,"div",15),e.TgZ(18,"label",16),e._uU(19,"Mostrar"),e.TgZ(20,"select",17),e.NdJ("ngModelChange",function(r){return o.service.pageSize=r}),e.TgZ(21,"option",18),e._uU(22,"10"),e.qZA(),e.TgZ(23,"option",18),e._uU(24,"25"),e.qZA(),e.TgZ(25,"option",18),e._uU(26,"50"),e.qZA(),e.TgZ(27,"option",18),e._uU(28,"100"),e.qZA(),e.qZA(),e._uU(29," entradas"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",2),e.TgZ(31,"div",19),e.TgZ(32,"div"),e.TgZ(33,"div",20),e.TgZ(34,"form"),e.TgZ(35,"table",21),e.TgZ(36,"thead"),e.TgZ(37,"tr",22),e.TgZ(38,"th",23),e.NdJ("sort",function(r){return o.onSort(r)}),e._uU(39,"Ord."),e.qZA(),e.TgZ(40,"th",24),e.NdJ("sort",function(r){return o.onSort(r)}),e._uU(41,"Fecha"),e.qZA(),e.TgZ(42,"th",25),e.NdJ("sort",function(r){return o.onSort(r)}),e._uU(43,"Nombre del Cliente"),e.qZA(),e.TgZ(44,"th",26),e.NdJ("sort",function(r){return o.onSort(r)}),e._uU(45,"Total"),e.qZA(),e.TgZ(46,"th",27),e.NdJ("sort",function(r){return o.onSort(r)}),e._uU(47,"Vendedor"),e.qZA(),e.TgZ(48,"th",26),e.NdJ("sort",function(r){return o.onSort(r)}),e._uU(49,"Estado de Pago"),e.qZA(),e.TgZ(50,"th",26),e.NdJ("sort",function(r){return o.onSort(r)}),e._uU(51,"Descargar Pdf"),e.qZA(),e.TgZ(52,"th",28),e._uU(53,"Acci\xf3n"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(54,"tbody"),e.YNc(55,Jt,26,21,"tr",29),e.ALo(56,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(57,Et,6,0,"div",30),e.TgZ(58,"div",31),e.TgZ(59,"div",19),e.TgZ(60,"div",32),e.TgZ(61,"ngb-pagination",33),e.NdJ("pageChange",function(r){return o.service.page=r}),e.ALo(62,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(63,Ot,94,35,"ng-template",null,34,e.W1O),e.qZA()),2&t&&(e.xp6(1),e.Q6J("breadcrumbItems",o.breadCrumbItems),e.xp6(6),e.Q6J("ngModel",o.service.searchTerm),e.xp6(5),e.Q6J("appRole",o.role),e.xp6(1),e.Q6J("appRole",o.role),e.xp6(2),e.Q6J("appRole",o.role),e.xp6(5),e.Q6J("ngModel",o.service.pageSize),e.xp6(1),e.Q6J("ngValue",10),e.xp6(2),e.Q6J("ngValue",25),e.xp6(2),e.Q6J("ngValue",50),e.xp6(2),e.Q6J("ngValue",100),e.xp6(28),e.Q6J("ngForOf",e.lcZ(56,18,o.transactions$)),e.xp6(2),e.Q6J("ngIf",!o.mostrarSpinner),e.xp6(4),e.Q6J("collectionSize",e.lcZ(62,20,o.total$))("page",o.service.page)("pageSize",o.service.pageSize)("maxSize",5)("rotate",!0)("boundaryLinks",!0))},directives:[$.V,s.Fj,s.JJ,s.On,j.g,s.EJ,s.YN,s.Kr,s._Y,s.JL,s.F,f.sg,f.O5,m.N9,s.sg,m.jt,D.w9,s.u,m._h,f.mk,m._L],pipes:[f.Ov,f.uU,f.H9],styles:[""]}),i})(),data:{role:["Vendedor","Admin"]},canActivate:[Y.a]},{path:"deletesales",component:(()=>{class i{constructor(t,o,a){this.fb=t,this.usuarioService=o,this.ventaService=a,this.role="Admin",this.nombre_sedes="campoSede",this.idSede=""}ngOnInit(){this.breadCrumbItems=[{label:"Ventas"},{label:"Ventas Eliminas",active:!0}],this.getListSedes(),this.crearFormulario()}getListSedes(){this.listSedes=JSON.parse(localStorage.getItem("sedes")),this.idSede=this.usuarioService.getSedebyUser()}crearFormulario(){this.formSedes=this.fb.group({[this.nombre_sedes]:[this.idSede,[s.kI.required]]})}fS(t){return this.formSedes.get(t)}exportarVentasEliminadas(){if(this.formSedes.valid){let t=[];const o="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8";this.ventaService.getVentasEliminadasbySede(this.fS(this.nombre_sedes).value).subscribe(r=>{if(r.length>0){t=r.map(v=>{let P=v.list_accesorios.map(p=>({"PRECIO VENTA":p.precio_accesorio_v,"PRECIO COMPRA":p.precio_accesorio_c,"CANTIDAD VENDIDA":p.cant_vendida,NOMBRE:p.nombre_accesorio,"SUMA TOTAL":p.precio})),Z=v.list_monturas.map(p=>({"PRECIO VENTA":p.precio_montura_v,"PRECIO COMPRA":p.precio_montura_c,"CANTIDAD VENDIDA":p.cant_vendida,MARCA:p.marca,MATERIAL:p.material,COLOR:p.color,"SUMA TOTAL":p.precio})),M=v.list_lunas.map(p=>({"PRECIO VENTA":p.precio_luna_v,"PRECIO COMPRA":p.precio_luna_c,"CANTIDAD VENDIDA":p.cant_vendida,MATERIAL:p.material,"SUMA TOTAL":p.precio}));return{FECHA:new Date(v.fecha_creacion_venta).toLocaleDateString("en-GB"),"NOMBRE CLIENTE":v.nombre_cliente,ACCESORIOS:JSON.stringify(P),LUNAS:JSON.stringify(M),MONTURAS:JSON.stringify(Z),TOTAL:v.tipo_venta[0].precio_total,USUARIO:v.nombre_vendedor.toUpperCase(),VENDEDOR:v.nombre_jalador?v.nombre_jalador.toUpperCase():null,"ENCARGADO MEDICION":v.encargado_medicion?v.encargado_medicion.toUpperCase():null,"FORMA DE PAGO":v.tipo_venta[0].forma_pago}});const h={Sheets:{hoja:Q.P6.json_to_sheet(t)},SheetNames:["hoja"]},N=Q.cW(h,{bookType:"xlsx",type:"array"}),S=new Blob([N],{type:o}),V=this.listSedes.find(v=>v.id_sede==this.fS(this.nombre_sedes).value);(0,ue.Z)(S,"ventas_eliminadas_"+V.nombre_sede)}else this.mostrarMensaje()})}}mostrarMensaje(){U().fire({title:"B\xfasqueda finalizada",text:"No existen ventas elimindas",icon:"error",confirmButtonColor:"#34c38f"})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(s.qu),e.Y36(R.i),e.Y36(F))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-deleted-sales"]],decls:21,vars:2,consts:[[1,"container-fluid"],["title","Ventas Eliminadas",3,"breadcrumbItems"],[1,"row"],[1,"col-lg-6"],[1,"card"],[1,"card-body"],[1,"card-title-desc","text-danger"],[1,"col-12","col-sm-12"],[1,"mb-3"],["for","validationCustom01"],["role","toolbar",1,"btn-toolbar"],["class","col-12 d-grid",4,"appRole"],[1,"row","my-2"],[1,"col"],[1,"text-sm-end","mt-2","mt-sm-0"],[1,"btn","btn-success",3,"click"],[1,"uil","uil-store-alt","me-1"],[1,"col-12","d-grid"],[3,"formGroup"],["ngbDropdown",""],["placeholder","Seleccione la sede","bindValue","id_sede","bindLabel","nombre_sede",3,"items","formControlName"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-page-title",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"p",6),e._uU(7,"* Campo requerido"),e.qZA(),e.TgZ(8,"div",2),e.TgZ(9,"div",7),e.TgZ(10,"div",8),e.TgZ(11,"label",9),e._uU(12,"Sede *"),e.qZA(),e.TgZ(13,"div",10),e.YNc(14,Qt,4,3,"div",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",12),e.TgZ(16,"div",13),e.TgZ(17,"div",14),e.TgZ(18,"button",15),e.NdJ("click",function(){return o.exportarVentasEliminadas()}),e._UZ(19,"i",16),e._uU(20," Descargar Archivo "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("breadcrumbItems",o.breadCrumbItems),e.xp6(13),e.Q6J("appRole",o.role))},directives:[$.V,j.g,s._Y,s.JL,s.sg,m.jt,D.w9,s.JJ,s.u],styles:[""]}),i})(),data:{role:["Vendedor","Admin"]},canActivate:[Y.a]}];let Yt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[te.Bz.forChild(Bt)],te.Bz]}),i})();var $t=d(2974);let jt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[{provide:ee._t,useValue:fe.v}],imports:[[Yt,f.ez,s.UX,s.u5,X.h,m.XC,ee.Ti,ve.v,W.bt,D.A0,m.jF,m.HK,m.Gs,m.ZS,m.lQ,m.Oz,m.IJ,re.rP,m.IJ,$t.o]]}),i})()}}]);